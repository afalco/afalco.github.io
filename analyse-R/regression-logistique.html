<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Régression logistique binaire, multinomiale et ordinale</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>
<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<meta name="robots" content="index, follow">
<link rel="stylesheet" href="./include/analyse-R.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js"></script>
<script type="text/javascript" src="./libs/bigfoot-2.1.4/bigfoot.min.js"></script>
<link rel="stylesheet" href="./libs/bigfoot-2.1.4/bigfoot-number.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<link rel="stylesheet" href="./libs/colorbox-1.6.1/colorbox.css" />
<script type="text/javascript" src="./libs/colorbox-1.6.1/jquery.colorbox-min.js"></script>
<!--- favicon --->
<link rel="apple-touch-icon" sizes="57x57" href="./images/favicon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="./images/favicon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="./images/favicon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="./images/favicon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="./images/favicon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="./images/favicon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="./images/favicon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="./images/favicon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="./images/favicon/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="./images/favicon/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="./images/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="./images/favicon/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="./images/favicon/favicon-16x16.png">
<link rel="manifest" href="./images/favicon/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="./images/favicon/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-121727005-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-121727005-1');
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">



<nav>
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href=".">analyse-R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
          <a href="manipuler" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Manipuler <span class="caret"></span></a>
          <ul class="dropdown-menu multi-column columns-3" role="menu" id="menu_manipuler">
            <div class="row">
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Prise en main</li>
                  <li><a href="presentation-et-philosophie.html">Présentation et Philosophie</a></li>
                  <li><a href="installation-de-R-et-RStudio.html">Installation de <strong>R</strong> et <strong>RStudio</strong></a></li>
                  <li><a href="premier-contact.html">Premier contact</a></li>
                  <li><a href="premier-travail-avec-les-donnees.html">Premier travail avec des données</a></li>
                  <li><a href="extensions.html">Extensions (installation, mise à jour)</a></li>
                  <li><a href="introduction-au-tidyverse.html">Introduction au <strong>tidyverse</strong></a></li>
                  <li><a href="vecteurs-indexation-et-assignation.html">Vecteurs, indexation et assignation</a></li>
                  <li><a href="listes-et-tableaux-de-donnes.html">Listes et Tableaux de données</a></li>
                  <li><a href="facteurs-et-vecteurs-labellises.html">Facteurs et vecteurs labellisés</a></li>
                  <li><a href="organiser-ses-fichiers.html">Organiser ses fichiers</a></li>
                  <li><a href="import-de-donnees.html">Import de données</a></li>
                  <li><a href="ou-trouver-de-l-aide.html">Où trouver de l'aide ?</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Manipulation de données</li>
  		            <li><a href="visualiser-ses-donnees.html">Visualiser ses données</a></li>
  		            <li><a href="recodage.html">Recodage de variables</a></li>
                  <li><a href="manipuler-les-donnees-avec-dplyr.html">Manipuler les données avec <strong>dplyr</strong></a></li>
                  <li><a href="manipulations-avancees-avec-data-table.html">Manipulations avancées avec <strong>data.table</strong></a></li>
                  <li><a href="tris.html">Tris</a></li>
                  <li><a href="sous-ensembles.html">Sous-ensembles</a></li>
                  <li><a href="fusion-de-tables.html">Fusion de tables</a></li>
                  <li><a href="gestion-des-dates.html">Gestion des dates</a></li>
                  <li><a href="fonctions-a-fenetre.html">Fonctions à fenêtre</a></li>
                  <li><a href="manipuler-du-texte.html">Manipuler du texte avec <strong>stringr</strong></a></li>
                  <li><a href="reorganiser-ses-donnees-avec-tidyr.html">Réorganiser ses données avec <strong>tidyr</strong></a></li>
                  <li><a href="scraping.html">Scraping</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
                  <li class="dropdown-header">Exporter</li>
                  <li><a href="export-de-donnees.html">Export de données</a></li>
                  <li><a href="export-de-graphiques.html">Export de graphiques</a></li>
  	            </ul>
              </div>
            </div>
          </ul>
        </li>
        <li class="dropdown">
          <a href="analyser" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Analyser <span class="caret"></span></a>
          <ul class="dropdown-menu multi-column columns-3" role="menu" id="menu_analyser">
            <div class="row">
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Statistiques introductives</li>
                  <li><a href="statistique-univariee.html">Statistique univariée</a></li>
                  <li><a href="statistique-bivariee.html">Statistique bivariée</a></li>
                  <li><a href="intro-ggplot2.html">Introduction à <strong>ggplot2</strong>, la grammaire des graphiques</a></li>
                  <li><a href="graphiques-bivaries-ggplot2.html">Graphiques univariés et bivariés avec <strong>ggplot2</strong></a></li>
                  <li><a href="donnees-ponderees.html">Données pondérées</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Statistiques intermédiaires</li>
  		            <li><a href="intervalles-de-confiance.html">Intervalles de confiance</a></li>
                  <li><a href="comparaisons-moyennes-et-proportions.html">Comparaisons (moyennes et proportions)</a></li>
                  <li><a href="definir-un-plan-d-echantillonnage-complexe.html">Définir un plan d'échantillonnage complexe</a></li>
                  <li><a href="regression-lineaire.html">Régression linéaire</a></li>
                  <li><a href="regression-logistique.html">Régression logistique binaire, multinomiale et ordinale</a></li>
                  <li><a href="analyse-des-correspondances-multiples.html">Analyse des correspondances multiples (ACM)</a></li>
                  <li><a href="classification-ascendante-hierarchique.html">Classification ascendante hiérarchique (CAH)</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
                  <li class="dropdown-header">Statistiques avancées</li>
                  <li><a href="effets-d-interaction.html">Effets d'interaction dans un modèle</a></li>
                  <li><a href="multicolinearite.html">Multicolinéarité dans la régression</a></li>
                  <li><a href="analyse-de-survie.html">Analyse de survie</a></li>
                  <li><a href="analyse-de-sequences.html">Analyse de séquences</a></li>
                  <!--<li><a href="modeles-a-effets-aleatoires.html">Modèles à effets aléatoires (modèles mixtes et GEE)</a></li>-->
                  <li><a href="trajectoires-de-soins.html">Trajectoires de soins&nbsp;: un exemple de données longitudinales</a></li>
                  <li><a href="analyse-de-reseaux.html">Analyse de réseaux</a></li>
                  <li><a href="analyse-spatiale.html">Analyse spatiale</a></li>
  	            </ul>
              </div>
            </div>
          </ul>
        </li>
        <li class="dropdown">
          <a href="approfondir" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Approfondir <span class="caret"></span></a>
          <ul class="dropdown-menu multi-column columns-3" role="menu" id="menu_approfondir">
            <div class="row">
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Graphiques</li>
                  <li><a href="ggplot2.html"><strong>ggplot2</strong> et la grammaire des graphiques</a></li>
                  <li><a href="etendre-ggplot2.html">Étendre ggplot2</a></li>
                  <li><a href="combiner-plusieurs-graphiques.html">Combiner plusieurs graphiques</a></li>
                  <li><a href="graphiques-interactifs.html">Graphiques interactifs</a></li>
                  <li><a href="lattice-graphiques-et-formules.html"><strong>lattice</strong> : graphiques et formules</a></li>
                  <li><a href="cartes.html">Cartes</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
  		            <li class="dropdown-header">Programmation</li>
  		            <li><a href="conditions-et-comparaisons.html">Conditions et comparaisons</a></li>
                  <li><a href="formules.html">Formules</a></li>
                  <li><a href="structures-conditionnelles.html">Structures conditionnelles</a></li>
                  <li><a href="vectorisation.html">Vectorisation</a></li>
                  <li><a href="expressions-regulieres.html">Expressions régulières</a></li>
                  <!--<li class="dev"><a href="ecrire-ses-propres-fonctions.html">Écrire ses propres fonctions</a></li>-->
                  <li><a href="rmarkdown-les-rapports-automatises.html"><strong>R Markdown</strong> : les rapports automatisés</a></li>
  	            </ul>
              </div>
              <div class="col-sm-4">
  	            <ul class="multi-column-dropdown">
                  <li class="dropdown-header">Divers</li>
                  <li><a href="formater-nombres.html">Mettre en forme des nombres</a></li>
                  <li><a href="couleurs.html">Couleurs et Palettes</a></li>
                  <li><a href="annotations-mathematiques.html">Annotations mathématiques</a></li>
                  <li><a href="calculer-un-age.html">Calculer un âge</a></li>
                  <li><a href="diagramme-de-lexis.html">Diagramme de Lexis</a></li>
  	            </ul>
              </div>
            </div>
          </ul>
        </li>
        <li class="dropdown">
          <a href="index" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Index <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu" id="menu_naviguer">
            <li><a href="index-des-concepts.html">Index des concepts</a></li>
            <li><a href="index-des-fonctions.html">Index des fonctions</a></li>
            <li><a href="index-des-extensions.html">Index des extensions</a></li>
          </ul>
        </li>
        <li><a href="analyse-R.pdf">PDF</a></li>
        <!--<li><a href="https://github.com/larmarange/analyse-R">GitHub</a></li>-->
      </ul>
    <form id="rechercher" class="navbar-form navbar-right" role="search" style="padding-top: 5px;" method="get" action="https://duckduckgo.com/">
      <div class="form-group">
        <input name="q" type="text" class="form-control input-sm" placeholder="Rechercher">
      </div>
      <button type="submit" class="btn btn-default btn-sm" name="Rechercher">
        <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
      </button>
    </form>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
</nav>

<div class="row">

<div class="visible-lg">
<a href="https://github.com/larmarange/analyse-R"><img style="position: absolute; top: 60px; left: 40px; border: 0;" src="./images/fork_me.png" alt="Contribuer sur GitHub"></a>
</div>

<div class="col-sm-9" role="main">
<article>

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Régression logistique binaire, multinomiale et ordinale</h1>

</div>

<div id="TOC">
<ul>
<li><a href="#preparation-des-donnees">Préparation des données</a></li>
<li><a href="#regression-logistique-binaire">Régression logistique binaire</a><ul>
<li><a href="#representation-graphique-du-modele">Représentation graphique du modèle</a></li>
<li><a href="#representation-graphique-des-effets">Représentation graphique des effets</a></li>
<li><a href="#matrice-de-confusion">Matrice de confusion</a></li>
<li><a href="#identifier-les-variables-ayant-un-effet-significatif">Identifier les variables ayant un effet significatif</a></li>
<li><a href="#selection-de-modeles">Sélection de modèles</a></li>
<li><a href="#tableaux-all-in-one">Tableaux <q>all-in-one</q></a></li>
<li><a href="#effets-dinteraction-dans-le-modele">Effets d’interaction dans le modèle</a></li>
<li><a href="#multicolinearite">Multicolinéarité</a></li>
</ul></li>
<li><a href="#regression-logistique-multinomiale">Régression logistique multinomiale</a></li>
<li><a href="#regression-logistique-ordinale">Régression logistique ordinale</a></li>
<li><a href="#survey">Données pondérées et l’extension survey</a><ul>
<li><a href="#regression-logistique-binaire-1">Régression logistique binaire</a></li>
<li><a href="#regression-multinomiale">Régression multinomiale</a></li>
<li><a href="#regression-ordinale">Régression ordinale</a></li>
</ul></li>
</ul>
</div>

<div class="note">
<p>La version originale de ce chapitre a été écrite par Joseph Larmarange dans le cadre du support de cours <a href="https://github.com/larmarange/intro-r/tree/CoursM2">Introduction à l’analyse d’enquêtes avec R</a>.</p>
</div>
<p>La <dfn>régression logistique</dfn><dfn data-index="logistique, régression"></dfn> est fréquemment utilisée en sciences sociales car elle permet d’effectuer un raisonnement dit <em>toutes choses étant égales par ailleurs</em>. Plus précisément, la régression logistique a pour but d’isoler les effets de chaque variable, c’est-à-dire d’identifier les effets résiduels d’une <dfn>variable explicative</dfn><dfn data-index="explicative, variable"></dfn> sur une <dfn>variable d’intérêt</dfn>, une fois pris en compte les autres variables explicatives introduites dans le modèle. La régression logistique est ainsi prisée en épidémiologie pour identifier les facteurs associés à telle ou telle pathologie.</p>
<p>La <dfn>régression logistique ordinaire</dfn><dfn data-index="ordinaire, régression logistique"></dfn> ou <dfn>régression logistique binaire</dfn><dfn data-index="binaire, régression logistique"></dfn> vise à expliquer une variable d’intérêt binaire (c’est-à-dire de type « oui / non » ou « vrai / faux »). Les variables explicatives qui seront introduites dans le modèle peuvent être <dfn data-index="variable quantitative">quantitatives</dfn><dfn data-index="quantitative, variable"></dfn> ou <dfn data-index="variable qualitative">qualitatives</dfn><dfn data-index="qualitative, variable"></dfn>.</p>
<p>La <dfn>régression logistique multinomiale</dfn><dfn data-index="multinomiale, régression logistique"></dfn> est une extension de la régression logistique aux variables qualitatives à trois modalités ou plus, la <dfn>régression logistique ordinale</dfn><dfn data-index="ordinale, régression logistique"></dfn> aux variables qualitatives à trois modalités ou plus qui sont ordonnées hiérarchiquement.</p>
<div id="preparation-des-donnees" class="section level2">
<h2>Préparation des données</h2>
<p>Dans ce chapite, nous allons encore une fois utiliser les données de l’enquête <em>Histoire de vie</em>, fournies avec l’extension <code class="pkg">questionr</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(questionr)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">data</span>(hdv2003)</a>
<a class="sourceLine" id="cb1-3" title="3">d &lt;-<span class="st"> </span>hdv2003</a></code></pre></div>
<p>À titre d’exemple, nous allons étudier l’effet de l’âge, du sexe, du niveau d’étude, de la pratique religieuse et du nombre moyen d’heures passées à regarder la télévision par jour sur le fait de pratiquer un sport.</p>
<p>En premier lieu, il importe de vérifier que notre variable d’intérêt (ici <em>sport</em>) est correctement codée. Une possibilité consiste à créer une <dfn>variable booléenne</dfn><dfn data-index="booléenne, variable"></dfn> (vrai / faux) selon que l’individu a pratiqué du sport ou non :</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">d<span class="op">$</span>sport2 &lt;-<span class="st"> </span><span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb2-2" title="2">d<span class="op">$</span>sport2[d<span class="op">$</span>sport <span class="op">==</span><span class="st"> &quot;Oui&quot;</span>] &lt;-<span class="st"> </span><span class="ot">TRUE</span></a></code></pre></div>
<p>Dans le cas présent, cette variable n’a pas de <dfn>valeur manquante</dfn><dfn data-index="manquante, valeur"></dfn>. Mais, le cas échéant, il importe de bien coder les valeurs manquantes en <code>NA</code>, les individus en question étant alors exclu de l’analyse.</p>
<p>Il n’est pas forcément nécessaire de transformer notre variable d’intérêt en variable booléenne. En effet, <strong>R</strong> accepte sans problème une variable de type <dfn>facteur</dfn>. Cependant, l’ordre des valeurs d’un facteur a de l’importance. En effet, <strong>R</strong> considère toujours la première modalité comme étant la <dfn>modalité de référence</dfn><dfn data-index="référence, modalité"></dfn>. Dans le cas de la variable d’intérêt, la modalité de référence correspond au fait de ne pas remplir le critère étudié, dans notre exemple au fait de ne pas avoir eu d’activité sportive au cours des douze derniers mois.</p>
<p>Pour connaître l’ordre des modalités d’une variable de type facteur, on peut utiliser la fonction <code data-pkg="base">levels</code> ou bien encore tout simplement la fonction <code data-pkg="questionr">freq</code> de l’extension <code class="pkg">questionr</code> :</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">levels</span>(d<span class="op">$</span>sport)</a></code></pre></div>
<pre><code>[1] &quot;Non&quot; &quot;Oui&quot;</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">freq</span>(d<span class="op">$</span>sport)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["n"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["%"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["val%"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"1277","2":"63.8","3":"63.8","_rn_":"Non"},{"1":"723","2":"36.1","3":"36.1","_rn_":"Oui"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Dans notre exemple, la modalité « Non » est déjà la première modalité. Il n’y a donc pas besoin de modifier notre variable. Si ce n’est pas le cas, il faudra modifier la modalité de référence avec la fonction <code data-pkg="stats">relevel</code> comme nous allons le voir un peu plus loin.</p>
<div class="important">
<p>Il est possible d’indiquer un facteur à plus de deux modalités. Dans une telle situation, <strong>R</strong> considérera que tous les modalités, sauf la modalité de référence, est une réalisation de la variable d’intérêt. Cela serait correct, par exemple, si notre variable <em>sport</em> était codée ainsi : « Non », « Oui, toutes les semaines », « Oui, au moins une fois par mois », « Oui, moins d’une fois par mois ». Cependant, afin d’éviter tout risque d’erreur ou de mauvaise interprétation, il est vivement conseillé de recoder au préalable sa variable d’intérêt en un facteur à deux modalités.</p>
</div>
<p>La notion de modalité de référence s’applique également aux variables explicatives qualitatives. En effet, dans un modèle, tous les coefficients sont calculés par rapport à la modalité de référence. Il importe de choisir une modalité de référence qui fasse sens afin de faciliter l’interprétation. Par ailleurs, ce choix peut également dépendre de la manière dont on souhaite présenter les résultats. De manière générale on évitera de choisir comme référence une modalité peu représentée dans l’échantillon ou bien une modalité correspondant à une situation atypique.</p>
<p>Prenons l’exemple de la variable <em>sexe</em>. Souhaite-t-on connaitre l’effet d’être une femme par rapport au fait d’être un homme ou bien l’effet d’être un homme par rapport au fait d’être une femme ? Si l’on opte pour le second, alors notre modalité de référence sera le sexe féminin. Comme est codée cette variable ?</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">freq</span>(d<span class="op">$</span>sexe)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["n"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["%"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["val%"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"899","2":"45","3":"45","_rn_":"Homme"},{"1":"1101","2":"55","3":"55","_rn_":"Femme"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>La modalité « Femme » s’avère ne pas être la première modalité. Nous devons appliquer la fonction <code data-pkg="stats">relevel</code> :</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">d<span class="op">$</span>sexe &lt;-<span class="st"> </span><span class="kw">relevel</span>(d<span class="op">$</span>sexe, <span class="st">&quot;Femme&quot;</span>)</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="kw">freq</span>(d<span class="op">$</span>sexe)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["n"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["%"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["val%"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"1101","2":"55","3":"55","_rn_":"Femme"},{"1":"899","2":"45","3":"45","_rn_":"Homme"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="important">
<p><strong>Données labellisées</strong></p>
<p>Si l’on utilise des données labellisées (voir le <a href="facteurs-et-vecteurs-labellises.html#labelled">chapitre dédié</a>), nos variables catégorielles seront stockées sous la forme d’un vecteur numérique avec des étiquettes. Il sera donc nécessaire de convertir ces variables en facteurs, tout simplement avec la fonction <code data-pkg="labelled">to_factor</code> de l’extension <code class="pkg">labelled</code> qui pourra utiliser les étiquettes de valeurs comme modalités du facteur.</p>
</div>
<p>Les variables <em>age</em> et <em>heures.tv</em> sont des variables quantitatives. Il importe de vérifier qu’elles sont bien enregistrées en tant que variables numériques. En effet, il arrive parfois que dans le fichier source les variables quantitatives soient renseignées sous forme de valeur textuelle et non sous forme numérique.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">str</span>(d<span class="op">$</span>age)</a></code></pre></div>
<pre><code> int [1:2000] 28 23 59 34 71 35 60 47 20 28 ...</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">str</span>(d<span class="op">$</span>heures.tv)</a></code></pre></div>
<pre><code> num [1:2000] 0 1 0 2 3 2 2.9 1 2 2 ...</code></pre>
<p>Nos deux variables sont bien renseignées sous forme numérique.</p>
<p>Cependant, l’effet de l’âge est rarement linéaire. Un exemple trivial est par exemple le fait d’occuper un emploi qui sera moins fréquent aux jeunes âges et aux âges élevés. Dès lors, on pourra transformer la variable <em>age</em> en groupe d’âges avec la fonction <code data-pkg="base">cut</code> (voir le chapitre <a href="pem_manipulation.html#decouper_en_classes">Manipulation de données</a>) :</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">d<span class="op">$</span>grpage &lt;-<span class="st"> </span><span class="kw">cut</span>(d<span class="op">$</span>age, <span class="kw">c</span>(<span class="dv">16</span>, <span class="dv">25</span>, <span class="dv">45</span>, <span class="dv">65</span>, <span class="dv">99</span>), <span class="dt">right =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb12-2" title="2">  <span class="dt">include.lowest =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb12-3" title="3"><span class="kw">freq</span>(d<span class="op">$</span>grpage)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["n"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["%"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["val%"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"169","2":"8.5","3":"8.5","_rn_":"[16,25)"},{"1":"706","2":"35.3","3":"35.3","_rn_":"[25,45)"},{"1":"745","2":"37.2","3":"37.2","_rn_":"[45,65)"},{"1":"380","2":"19.0","3":"19.0","_rn_":"[65,99]"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Jetons maintenant un oeil à la variable <em>nivetud</em> :</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">freq</span>(d<span class="op">$</span>nivetud)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["n"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["%"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["val%"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"39","2":"2.0","3":"2.1","_rn_":"N'a jamais fait d'etudes"},{"1":"86","2":"4.3","3":"4.6","_rn_":"A arrete ses etudes, avant la derniere annee d'etudes primaires"},{"1":"341","2":"17.1","3":"18.1","_rn_":"Derniere annee d'etudes primaires"},{"1":"204","2":"10.2","3":"10.8","_rn_":"1er cycle"},{"1":"183","2":"9.2","3":"9.7","_rn_":"2eme cycle"},{"1":"463","2":"23.2","3":"24.5","_rn_":"Enseignement technique ou professionnel court"},{"1":"131","2":"6.6","3":"6.9","_rn_":"Enseignement technique ou professionnel long"},{"1":"441","2":"22.1","3":"23.4","_rn_":"Enseignement superieur y compris technique superieur"},{"1":"112","2":"5.6","3":"NA","_rn_":"__NA__"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>En premier lieu, cette variable est détaillée en pas moins de huit modalités dont certaines sont peu représentées (seulement 39 individus soit 2 % n’ont jamais fait d’études par exemple). Afin d’améliorier notre modèle logistique, il peut être pertinent de regrouper certaines modalités (voir le chapitre <a href="pem_manipulation.html#regrouper_modalites">Manipulation de données</a>) :</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">d<span class="op">$</span>etud &lt;-<span class="st"> </span>d<span class="op">$</span>nivetud</a>
<a class="sourceLine" id="cb14-2" title="2"><span class="kw">levels</span>(d<span class="op">$</span>etud) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Primaire&quot;</span>, <span class="st">&quot;Primaire&quot;</span>, <span class="st">&quot;Primaire&quot;</span>, <span class="st">&quot;Secondaire&quot;</span>, </a>
<a class="sourceLine" id="cb14-3" title="3">  <span class="st">&quot;Secondaire&quot;</span>, <span class="st">&quot;Technique/Professionnel&quot;</span>, <span class="st">&quot;Technique/Professionnel&quot;</span>, </a>
<a class="sourceLine" id="cb14-4" title="4">  <span class="st">&quot;Supérieur&quot;</span>)</a>
<a class="sourceLine" id="cb14-5" title="5"><span class="kw">freq</span>(d<span class="op">$</span>etud)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["n"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["%"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["val%"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"466","2":"23.3","3":"24.7","_rn_":"Primaire"},{"1":"387","2":"19.4","3":"20.5","_rn_":"Secondaire"},{"1":"594","2":"29.7","3":"31.5","_rn_":"Technique/Professionnel"},{"1":"441","2":"22.1","3":"23.4","_rn_":"Supérieur"},{"1":"112","2":"5.6","3":"NA","_rn_":"__NA__"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Notre variable comporte également 112 individus avec une valeur manquante. Si nous conservons cette valeur manquante, ces 112 individus seront, par défaut, exclus de l’analyse. Ces valeurs manquantes n’étant pas négligeable (5,6 %), nous pouvons également faire le choix de considérer ces valeurs manquantes comme une modalité supplémentaire. Auquel cas, nous utiliserons la fonction <code data-pkg="questionr">addNAstr</code> fournie par <code class="pkg">questionr</code><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> :</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">levels</span>(d<span class="op">$</span>etud)</a></code></pre></div>
<pre><code>[1] &quot;Primaire&quot;                &quot;Secondaire&quot;             
[3] &quot;Technique/Professionnel&quot; &quot;Supérieur&quot;              </code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">d<span class="op">$</span>etud &lt;-<span class="st"> </span><span class="kw">addNAstr</span>(d<span class="op">$</span>etud, <span class="st">&quot;manquant&quot;</span>)</a>
<a class="sourceLine" id="cb17-2" title="2"><span class="kw">levels</span>(d<span class="op">$</span>etud)</a></code></pre></div>
<pre><code>[1] &quot;Primaire&quot;                &quot;Secondaire&quot;             
[3] &quot;Technique/Professionnel&quot; &quot;Supérieur&quot;              
[5] &quot;manquant&quot;               </code></pre>
</div>
<div id="regression-logistique-binaire" class="section level2">
<h2>Régression logistique binaire</h2>
<p>La fonction <code data-pkg="stats">glm</code> (pour <dfn lang="en">generalized linear models</dfn> soit <dfn>modèle linéaire généralisé</dfn> en français) permet de calculer une grande variété de modèles statistiques. La régression logistique ordinaire correspond au modèle <em>logit</em> de la famille des modèles binomiaux, ce que l’on indique à <code data-pkg="stats">glm</code> avec l’argument <code>family=binomial(logit)</code>.</p>
<p>Le modèle proprement dit sera renseigné sous la forme d’une <dfn>formule</dfn> (que nous avons déjà rencontrée dans le chapitre sur la <a href="statistique-bivariee.html">statistique bivariée</a> et présentée plus en détails dans un <a href="formules.html">chapitre dédié</a>). On indiquera d’abord la variable d’intérêt, suivie du signe <code>~</code> (que l’on obtient en appuyant sur les touches <kbd>Alt Gr</kbd> et <kbd>3</kbd> sur un clavier de type PC) puis de la liste des variables explicatives séparées par un signe <code>+</code>. Enfin, l’argument <code>data</code> permettra d’indiquer notre tableau de données.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">reg &lt;-<span class="st"> </span><span class="kw">glm</span>(sport <span class="op">~</span><span class="st"> </span>sexe <span class="op">+</span><span class="st"> </span>grpage <span class="op">+</span><span class="st"> </span>etud <span class="op">+</span><span class="st"> </span>relig <span class="op">+</span><span class="st"> </span>heures.tv, </a>
<a class="sourceLine" id="cb19-2" title="2">  <span class="dt">data =</span> d, <span class="dt">family =</span> <span class="kw">binomial</span>(logit))</a>
<a class="sourceLine" id="cb19-3" title="3">reg</a></code></pre></div>
<pre><code>
Call:  glm(formula = sport ~ sexe + grpage + etud + relig + heures.tv, 
    family = binomial(logit), data = d)

Coefficients:
                     (Intercept)  
                       -0.798368  
                       sexeHomme  
                        0.439694  
                   grpage[25,45)  
                       -0.420448  
                   grpage[45,65)  
                       -1.085434  
                   grpage[65,99]  
                       -1.381353  
                  etudSecondaire  
                        0.950571  
     etudTechnique/Professionnel  
                        1.049253  
                   etudSupérieur  
                        1.891667  
                    etudmanquant  
                        2.150428  
     religPratiquant occasionnel  
                       -0.021904  
 religAppartenance sans pratique  
                       -0.006696  
religNi croyance ni appartenance  
                       -0.215389  
                      religRejet  
                       -0.383543  
                religNSP ou NVPR  
                       -0.083789  
                       heures.tv  
                       -0.120911  

Degrees of Freedom: 1994 Total (i.e. Null);  1980 Residual
  (5 observations deleted due to missingness)
Null Deviance:      2609 
Residual Deviance: 2206     AIC: 2236</code></pre>
<div class="note">
<p>Il est possible de spécifier des modèles plus complexes. Par exemple, <code>x:y</code> permet d’indiquer l’interaction entre les variables <em>x</em> et <em>y</em>. <code>x * y</code> sera équivalent à <code>x + y + x:y</code>. Pour aller plus loin, voir <a href="http://ww2.coastal.edu/kingw/statistics/R-tutorials/formulae.html" class="uri">http://ww2.coastal.edu/kingw/statistics/R-tutorials/formulae.html</a>.</p>
</div>
<p>Une présentation plus complète des résultats est obtenue avec la méthode <code data-pkg="stats" data-rdoc="summary.glm">summary</code> :</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">summary</span>(reg)</a></code></pre></div>
<pre><code>
Call:
glm(formula = sport ~ sexe + grpage + etud + relig + heures.tv, 
    family = binomial(logit), data = d)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.8784  -0.8865  -0.4808   1.0033   2.4222  

Coefficients:
                                  Estimate Std. Error
(Intercept)                      -0.798368   0.323903
sexeHomme                         0.439694   0.106062
grpage[25,45)                    -0.420448   0.228053
grpage[45,65)                    -1.085434   0.237716
grpage[65,99]                    -1.381353   0.273796
etudSecondaire                    0.950571   0.197442
etudTechnique/Professionnel       1.049253   0.189804
etudSupérieur                     1.891667   0.195218
etudmanquant                      2.150428   0.330229
religPratiquant occasionnel      -0.021904   0.189199
religAppartenance sans pratique  -0.006696   0.174737
religNi croyance ni appartenance -0.215389   0.193080
religRejet                       -0.383543   0.285905
religNSP ou NVPR                 -0.083789   0.411028
heures.tv                        -0.120911   0.033591
                                 z value Pr(&gt;|z|)    
(Intercept)                       -2.465 0.013708 *  
sexeHomme                          4.146 3.39e-05 ***
grpage[25,45)                     -1.844 0.065236 .  
grpage[45,65)                     -4.566 4.97e-06 ***
grpage[65,99]                     -5.045 4.53e-07 ***
etudSecondaire                     4.814 1.48e-06 ***
etudTechnique/Professionnel        5.528 3.24e-08 ***
etudSupérieur                      9.690  &lt; 2e-16 ***
etudmanquant                       6.512 7.42e-11 ***
religPratiquant occasionnel       -0.116 0.907833    
religAppartenance sans pratique   -0.038 0.969434    
religNi croyance ni appartenance  -1.116 0.264617    
religRejet                        -1.342 0.179756    
religNSP ou NVPR                  -0.204 0.838470    
heures.tv                         -3.599 0.000319 ***
---
Signif. codes:  
0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2609.2  on 1994  degrees of freedom
Residual deviance: 2206.2  on 1980  degrees of freedom
  (5 observations deleted due to missingness)
AIC: 2236.2

Number of Fisher Scoring iterations: 4</code></pre>
<p>Dans le cadre d’un modèle logistique, généralement on ne présente pas les <dfn data-index="coefficient, modèle">coefficients</dfn> du modèle mais leur valeur exponentielle, cette dernière correspondant en effet à des <dfn data-index="odds ratio" lang="en">odds ratio</dfn>, également appelés <dfn data-index="rapport des cotes">rapports des cotes</dfn>. L’odds ratio diffère du <dfn>risque relatif</dfn><dfn data-index="relatif, risque"></dfn>. Cependent son interprétation est similaire. Un <em>odds ratio</em> de 1 signifie l’absence d’effet. Un <em>odds ratio</em> largement supérieur à 1 correspond à une augmentation du phénomène étudié et un <em>odds ratio</em> largement inféieur à 1 correspond à une diminution du phénomène étudié<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>.</p>
<p>La fonction <code data-pkg="stats">coef</code> permet d’obtenir les coefficients d’un modèle, <code data-pkg="stats">confint</code> leurs intervalles de confiance et <code data-pkg="base" data-rdoc="log">exp</code> de calculer l’exponentiel. Les <em>odds ratio</em> et leurs <dfn data-index="intervalle de confiance d'un odds ratio">intervalles de confiance</dfn><dfn data-index="odds ratio, intervalle de confiance"></dfn> s’obtiennent ainsi :</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">exp</span>(<span class="kw">coef</span>(reg))</a></code></pre></div>
<pre><code>                     (Intercept) 
                       0.4500628 
                       sexeHomme 
                       1.5522329 
                   grpage[25,45) 
                       0.6567525 
                   grpage[45,65) 
                       0.3377552 
                   grpage[65,99] 
                       0.2512383 
                  etudSecondaire 
                       2.5871865 
     etudTechnique/Professionnel 
                       2.8555168 
                   etudSupérieur 
                       6.6304155 
                    etudmanquant 
                       8.5885303 
     religPratiquant occasionnel 
                       0.9783342 
 religAppartenance sans pratique 
                       0.9933267 
religNi croyance ni appartenance 
                       0.8062276 
                      religRejet 
                       0.6814428 
                religNSP ou NVPR 
                       0.9196256 
                       heures.tv 
                       0.8861129 </code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">exp</span>(<span class="kw">confint</span>(reg))</a></code></pre></div>
<pre><code>Waiting for profiling to be done...</code></pre>
<pre><code>                                     2.5 %     97.5 %
(Intercept)                      0.2377004  0.8473181
sexeHomme                        1.2614265  1.9120047
grpage[25,45)                    0.4194391  1.0274553
grpage[45,65)                    0.2115307  0.5380894
grpage[65,99]                    0.1463860  0.4288023
etudSecondaire                   1.7652682  3.8327896
etudTechnique/Professionnel      1.9804881  4.1729378
etudSupérieur                    4.5517938  9.7950691
etudmanquant                     4.5347799 16.5885323
religPratiquant occasionnel      0.6758807  1.4198530
religAppartenance sans pratique  0.7063000  1.4020242
religNi croyance ni appartenance 0.5524228  1.1782475
religRejet                       0.3868800  1.1889781
religNSP ou NVPR                 0.3996746  2.0215562
heures.tv                        0.8290223  0.9457756</code></pre>
<p>On pourra faciliter la lecture en combinant les deux :</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="kw">exp</span>(<span class="kw">cbind</span>(<span class="kw">coef</span>(reg), <span class="kw">confint</span>(reg)))</a></code></pre></div>
<pre><code>Waiting for profiling to be done...</code></pre>
<pre><code>                                               2.5 %
(Intercept)                      0.4500628 0.2377004
sexeHomme                        1.5522329 1.2614265
grpage[25,45)                    0.6567525 0.4194391
grpage[45,65)                    0.3377552 0.2115307
grpage[65,99]                    0.2512383 0.1463860
etudSecondaire                   2.5871865 1.7652682
etudTechnique/Professionnel      2.8555168 1.9804881
etudSupérieur                    6.6304155 4.5517938
etudmanquant                     8.5885303 4.5347799
religPratiquant occasionnel      0.9783342 0.6758807
religAppartenance sans pratique  0.9933267 0.7063000
religNi croyance ni appartenance 0.8062276 0.5524228
religRejet                       0.6814428 0.3868800
religNSP ou NVPR                 0.9196256 0.3996746
heures.tv                        0.8861129 0.8290223
                                     97.5 %
(Intercept)                       0.8473181
sexeHomme                         1.9120047
grpage[25,45)                     1.0274553
grpage[45,65)                     0.5380894
grpage[65,99]                     0.4288023
etudSecondaire                    3.8327896
etudTechnique/Professionnel       4.1729378
etudSupérieur                     9.7950691
etudmanquant                     16.5885323
religPratiquant occasionnel       1.4198530
religAppartenance sans pratique   1.4020242
religNi croyance ni appartenance  1.1782475
religRejet                        1.1889781
religNSP ou NVPR                  2.0215562
heures.tv                         0.9457756</code></pre>
<p>Pour savoir si un <em>odds ratio</em> diffère significativement de 1 (ce qui est identique au fait que le coefficient soit différent de 0), on pourra se référer à la colonne <em>Pr(&gt;|z|)</em> obtenue avec <code data-pkg="stats" data-rdoc="summary.glm">summary</code>.</p>
<p>Si vous disposez de l’extension <code class="pkg">questionr</code>, la fonction <code data-pacakge="questionr">odds.ratio</code> permet de calculer directement les <em>odds ratio</em>, leur intervalles de confiance et les <em>p-value</em> :</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="kw">library</span>(questionr)</a>
<a class="sourceLine" id="cb31-2" title="2"><span class="kw">odds.ratio</span>(reg)</a></code></pre></div>
<pre><code>Waiting for profiling to be done...</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["OR"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["2.5 %"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["97.5 %"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["p"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.4500628","2":"0.2377004","3":"0.8473181","4":"1.370761e-02","_rn_":"(Intercept)"},{"1":"1.5522329","2":"1.2614265","3":"1.9120047","4":"3.388995e-05","_rn_":"sexeHomme"},{"1":"0.6567525","2":"0.4194391","3":"1.0274553","4":"6.523578e-02","_rn_":"grpage[25,45)"},{"1":"0.3377552","2":"0.2115307","3":"0.5380894","4":"4.968863e-06","_rn_":"grpage[45,65)"},{"1":"0.2512383","2":"0.1463860","3":"0.4288023","4":"4.530833e-07","_rn_":"grpage[65,99]"},{"1":"2.5871865","2":"1.7652682","3":"3.8327896","4":"1.476280e-06","_rn_":"etudSecondaire"},{"1":"2.8555168","2":"1.9804881","3":"4.1729378","4":"3.237229e-08","_rn_":"etudTechnique/Professionnel"},{"1":"6.6304155","2":"4.5517938","3":"9.7950691","4":"3.323809e-22","_rn_":"etudSupérieur"},{"1":"8.5885303","2":"4.5347799","3":"16.5885323","4":"7.419197e-11","_rn_":"etudmanquant"},{"1":"0.9783342","2":"0.6758807","3":"1.4198530","4":"9.078331e-01","_rn_":"religPratiquant occasionnel"},{"1":"0.9933267","2":"0.7063000","3":"1.4020242","4":"9.694337e-01","_rn_":"religAppartenance sans pratique"},{"1":"0.8062276","2":"0.5524228","3":"1.1782475","4":"2.646171e-01","_rn_":"religNi croyance ni appartenance"},{"1":"0.6814428","2":"0.3868800","3":"1.1889781","4":"1.797562e-01","_rn_":"religRejet"},{"1":"0.9196256","2":"0.3996746","3":"2.0215562","4":"8.384696e-01","_rn_":"religNSP ou NVPR"},{"1":"0.8861129","2":"0.8290223","3":"0.9457756","4":"3.188426e-04","_rn_":"heures.tv"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div id="representation-graphique-du-modele" class="section level3">
<h3>Représentation graphique du modèle</h3>
<p>Il est possible de représenter graphiquement les différents odds ratios. Pour cela, on va utiliser la fonction <code data-pkg="broom" data-rdoc="gm_tidiers">tidy</code> de l’extension <code class="pkg">broom</code> pour récupérer les coefficients du modèle sous la forme d’un tableau de données exploitable avec <code class="pkg">ggplot2</code>. On précisera <code>conf.int = TRUE</code> pour obtenir les intervalles de confiance et <code>exponentiate = TRUE</code> pour avoir les odds ratio plutôt que les coefficients bruts. <code data-pkg="ggplot2" data-rdoc="geom_crossbar">geom_errorbarh</code> permets de représenter les intervalles de confiance sous forme de barres d’erreurs, <code data-pkg="ggplot2" data-rdoc="geom_abline">geom_vline</code> une ligne verticale au niveau <code>x = 1</code>, <code data-pkg="ggplot2" data-rdoc="scale_continuous">scale_x_log10</code> pour afficher l’axe des <code>x</code> de manière logarithmique, les odds ratios étant de nature multiplicative et non additive.</p>
<figure>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="kw">library</span>(broom)</a>
<a class="sourceLine" id="cb33-2" title="2">tmp &lt;-<span class="st"> </span><span class="kw">tidy</span>(reg, <span class="dt">conf.int =</span> <span class="ot">TRUE</span>, <span class="dt">exponentiate =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb33-3" title="3"><span class="kw">str</span>(tmp)</a></code></pre></div>
<pre><code>Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:   15 obs. of  7 variables:
 $ term     : chr  &quot;(Intercept)&quot; &quot;sexeHomme&quot; &quot;grpage[25,45)&quot; &quot;grpage[45,65)&quot; ...
 $ estimate : num  0.45 1.552 0.657 0.338 0.251 ...
 $ std.error: num  0.324 0.106 0.228 0.238 0.274 ...
 $ statistic: num  -2.46 4.15 -1.84 -4.57 -5.05 ...
 $ p.value  : num  1.37e-02 3.39e-05 6.52e-02 4.97e-06 4.53e-07 ...
 $ conf.low : num  0.238 1.261 0.419 0.212 0.146 ...
 $ conf.high: num  0.847 1.912 1.027 0.538 0.429 ...</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb35-2" title="2"><span class="kw">ggplot</span>(tmp) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> estimate, <span class="dt">y =</span> term, <span class="dt">xmin =</span> conf.low, <span class="dt">xmax =</span> conf.high) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb35-3" title="3"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_errorbarh</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb35-4" title="4"><span class="st">  </span><span class="kw">scale_x_log10</span>()</a></code></pre></div>
<img src="graphs/regression-logistique/unnamed-chunk-16-1.png" width="1050" />
<figcaption>
Représentation graphique des odds ratios
</figcaption>
</figure>
<p>La fonction <code data-pkg="GGally">ggcoef</code> de l’extension <code class="pkg">GGally</code> permet d’effectuer le graphique précédent directement à partir de notre modèle. Voir l’aide de cette fonction pour la liste complète des paramètres personnalisables.</p>
<figure>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="kw">library</span>(GGally)</a>
<a class="sourceLine" id="cb36-2" title="2"><span class="kw">ggcoef</span>(reg, <span class="dt">exponentiate =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<img src="graphs/regression-logistique/unnamed-chunk-17-1.png" width="1050" />
<figcaption>
La fonction ggcoef
</figcaption>
</figure>
<div class="note">
<p>L’extension <code class="pkg">JLutils</code>, disponible uniquement sur GitHub, propose une fonction intéressante dans ce contexte. Pour l’installer ou la mettre à jour, si ce n’est déjà fait, on aura recours à la commande ci-après.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;larmarange/JLutils&quot;</span>)</a></code></pre></div>
<p>La fonction <code data-pkg="JLutils">tidy_detailed</code> est une version <q>élargie</q> de <code data-pkg="broom">tidy</code> qui rajoute des colonnes supplémentaires avec le nom des variables et des modalités.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="kw">str</span>(<span class="kw">tidy</span>(reg))</a></code></pre></div>
<pre><code>Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:   15 obs. of  5 variables:
 $ term     : chr  &quot;(Intercept)&quot; &quot;sexeHomme&quot; &quot;grpage[25,45)&quot; &quot;grpage[45,65)&quot; ...
 $ estimate : num  -0.798 0.44 -0.42 -1.085 -1.381 ...
 $ std.error: num  0.324 0.106 0.228 0.238 0.274 ...
 $ statistic: num  -2.46 4.15 -1.84 -4.57 -5.05 ...
 $ p.value  : num  1.37e-02 3.39e-05 6.52e-02 4.97e-06 4.53e-07 ...</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="kw">library</span>(JLutils)</a>
<a class="sourceLine" id="cb40-2" title="2"><span class="kw">str</span>(<span class="kw">tidy_detailed</span>(reg))</a></code></pre></div>
<pre><code>&#39;data.frame&#39;:   15 obs. of  10 variables:
 $ term          : chr  &quot;(Intercept)&quot; &quot;etudmanquant&quot; &quot;etudSecondaire&quot; &quot;etudSupérieur&quot; ...
 $ estimate      : num  -0.798 2.15 0.951 1.892 1.049 ...
 $ std.error     : num  0.324 0.33 0.197 0.195 0.19 ...
 $ statistic     : num  -2.46 6.51 4.81 9.69 5.53 ...
 $ p.value       : num  1.37e-02 7.42e-11 1.48e-06 3.32e-22 3.24e-08 ...
 $ variable      : chr  NA &quot;etud&quot; &quot;etud&quot; &quot;etud&quot; ...
 $ variable_label: chr  NA &quot;etud&quot; &quot;etud&quot; &quot;etud&quot; ...
 $ level         : chr  NA &quot;manquant&quot; &quot;Secondaire&quot; &quot;Supérieur&quot; ...
 $ level_detail  : chr  NA &quot;manquant vs. Primaire&quot; &quot;Secondaire vs. Primaire&quot; &quot;Supérieur vs. Primaire&quot; ...
 $ label         : chr  NA &quot;manquant vs. Primaire&quot; &quot;Secondaire vs. Primaire&quot; &quot;Supérieur vs. Primaire&quot; ...</code></pre>
<p>Il est possible de combiner <code data-pkg="JLutils">tidy_detailed</code> avec <code data-pkg="GGally">ggcoef</code> pour personnaliser un peu plus le résultat.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1">td &lt;-<span class="st"> </span><span class="kw">tidy_detailed</span>(reg, <span class="dt">exponentiate =</span> <span class="ot">TRUE</span>, <span class="dt">conf.int =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb42-2" title="2">td<span class="op">$</span>level_detail &lt;-<span class="st"> </span><span class="kw">factor</span>(td<span class="op">$</span>label, <span class="kw">rev</span>(td<span class="op">$</span>level_detail))  <span class="co"># Pour fixer l&#39;ordre pour ggplot2</span></a>
<a class="sourceLine" id="cb42-3" title="3"><span class="kw">ggcoef</span>(td, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">y =</span> level_detail, <span class="dt">x =</span> estimate, <span class="dt">colour =</span> variable_label), </a>
<a class="sourceLine" id="cb42-4" title="4">  <span class="dt">exponentiate =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="graphs/regression-logistique/unnamed-chunk-20-1.png" width="1050" /></p>
</div>
<p>L’extension <code class="pkg">forestmodel</code> propose de son côté une fonction <code>forest_model</code>{pkg = “forestmodel”} qui, à partir d’un modèle, propose une représentation visuelle et tabulaire des coefficients.</p>
<figure>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="kw">library</span>(forestmodel)</a>
<a class="sourceLine" id="cb43-2" title="2"><span class="kw">forest_model</span>(reg)</a></code></pre></div>
<img src="graphs/regression-logistique/unnamed-chunk-21-1.png" width="1800" />
<figcaption>
La fonction forest_model
</figcaption>
</figure>
</div>
<div id="representation-graphique-des-effets" class="section level3">
<h3>Représentation graphique des effets</h3>
<p>L’extension <code class="pkg">effects</code> propose une représentation graphique résumant les effets de chaque variable du modèle. Pour cela, il suffit d’appliquer la méthode <code data-pkg="effects" data-rdoc="summary.effect">plot</code> au résultat de la fonction <code data-pkg="effects" data-rdoc="effect">allEffects</code>. Nous obtenons alors la <a href="#reglog_alleffects">figure ci-dessous</a>.</p>
<figure id="reglog_alleffects">
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="kw">library</span>(effects)</a>
<a class="sourceLine" id="cb44-2" title="2"><span class="kw">plot</span>(<span class="kw">allEffects</span>(reg))</a></code></pre></div>
<img src="graphs/regression-logistique/plot_allEffects-1.png" width="1050" />
<figcaption>
Représentation graphique de l’effet de chaque variable du modèle logistique
</figcaption>
</figure>
<p>Nous pouvons alternativement avoir recours à l’extension <code class="pkg">ggeffects</code><a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> et sa fonction <code data-pkg="ggeffects">ggeffect</code> qui permettent de récupérer les résultats de <code class="pkg">effects</code> dans un format utilisable avec <code class="pkg">ggplot2</code>.</p>
<p>Ainsi, la fonction <code data-pkg="ggeffects">ggeffect</code>, quand on lui précise un terme spécifique, produit un tableau de données avec les effets marginaux pour cette variable.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"><span class="kw">library</span>(ggeffects)</a>
<a class="sourceLine" id="cb45-2" title="2"><span class="kw">ggeffect</span>(reg, <span class="st">&quot;sexe&quot;</span>)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["x"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["predicted"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["conf.low"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["conf.high"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["group"],"name":[6],"type":["fctr"],"align":["left"]}],"data":[{"1":"1","2":"0.2845797","3":"0.07559548","4":"0.2553990","5":"0.3156809","6":"1"},{"1":"2","2":"0.3817416","3":"0.07834807","4":"0.3462142","5":"0.4185805","6":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>En combinant ce résultat avec <code data-pkg="effects">plot</code>, on obtient un graphique <code class="pkg">ggplot2</code> de l’effet en question.</p>
<figure>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1"><span class="kw">plot</span>(<span class="kw">ggeffect</span>(reg, <span class="st">&quot;sexe&quot;</span>))</a></code></pre></div>
<img src="graphs/regression-logistique/unnamed-chunk-23-1.png" width="1050" />
<figcaption>
Effet du sexe représenté avec ggeffect
</figcaption>
</figure>
<p>Si l’on ne précise pas de terme, <code>ggeffect(reg)</code> calcule les effets pour chaque variable du modèle et <code>plot(ggeffect(reg))</code> renvoie une liste de graphiques. Il faut donc utiliser la fonction <code data-pkg="cowplot">plot_grid</code> de <code class="pkg">cowplot</code> pour combiner ces graphiques en un seul (voir le <a href="combiner-plusieurs-graphiques.html">chapitre dédié</a>).</p>
<figure>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"><span class="kw">library</span>(ggeffects)</a>
<a class="sourceLine" id="cb47-2" title="2">cowplot<span class="op">::</span><span class="kw">plot_grid</span>(<span class="dt">plotlist =</span> <span class="kw">plot</span>(<span class="kw">ggeffect</span>(reg)))</a></code></pre></div>
<img src="graphs/regression-logistique/unnamed-chunk-24-1.png" width="1800" />
<figcaption>
Effet du modèles représentés avec ggeffect
</figcaption>
</figure>
<p>Si l’on souhaite avoir des noms de variables plus explicites, il faut ajouter des étiquettes des variables avec <code data-pkg="labelled">var_label</code> de l’extension <code class="pkg">labelled</code> (voir le <a href="facteurs-et-vecteurs-labellises.html#les-etiquettes-de-variable">chapitre sur les vecteurs labellisés</a>).</p>
<p>Par contre, cette étape doit avoir eu lieu avant le calcul de la régression linéaire.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="kw">library</span>(labelled)</a>
<a class="sourceLine" id="cb48-2" title="2"><span class="kw">var_label</span>(d<span class="op">$</span>sport) &lt;-<span class="st"> &quot;Pratique du sport ?&quot;</span></a>
<a class="sourceLine" id="cb48-3" title="3"><span class="kw">var_label</span>(d<span class="op">$</span>sexe) &lt;-<span class="st"> &quot;Sexe&quot;</span></a>
<a class="sourceLine" id="cb48-4" title="4"><span class="kw">var_label</span>(d<span class="op">$</span>grpage) &lt;-<span class="st"> &quot;Groupe d&#39;âges&quot;</span></a>
<a class="sourceLine" id="cb48-5" title="5"><span class="kw">var_label</span>(d<span class="op">$</span>etud) &lt;-<span class="st"> &quot;Niveau d&#39;étude&quot;</span></a>
<a class="sourceLine" id="cb48-6" title="6"><span class="kw">var_label</span>(d<span class="op">$</span>relig) &lt;-<span class="st"> &quot;Pratique religieuse&quot;</span></a>
<a class="sourceLine" id="cb48-7" title="7"><span class="kw">var_label</span>(d<span class="op">$</span>heures.tv) &lt;-<span class="st"> &quot;Nombre d&#39;heures passées devant la télévision par jour&quot;</span></a>
<a class="sourceLine" id="cb48-8" title="8">reg &lt;-<span class="st"> </span><span class="kw">glm</span>(sport <span class="op">~</span><span class="st"> </span>sexe <span class="op">+</span><span class="st"> </span>grpage <span class="op">+</span><span class="st"> </span>etud <span class="op">+</span><span class="st"> </span>relig <span class="op">+</span><span class="st"> </span>heures.tv, </a>
<a class="sourceLine" id="cb48-9" title="9">  <span class="dt">data =</span> d, <span class="dt">family =</span> <span class="kw">binomial</span>(logit))</a></code></pre></div>
<figure>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1">cowplot<span class="op">::</span><span class="kw">plot_grid</span>(<span class="dt">plotlist =</span> <span class="kw">plot</span>(<span class="kw">ggeffect</span>(reg)))</a></code></pre></div>
<img src="graphs/regression-logistique/unnamed-chunk-26-1.png" width="1800" />
<figcaption>
Effet du modèles avec étiquettes de variable
</figcaption>
</figure>
</div>
<div id="matrice-de-confusion" class="section level3">
<h3>Matrice de confusion</h3>
<p>Une manière de tester la qualité d’un modèle est le calcul d’une <dfn>matrice de confusion</dfn><dfn data-index="confusion, matrice"></dfn>, c’est-à-dire le tableau croisé des valeurs observées et celles des valeurs prédites en appliquant le modèle aux données d’origine.</p>
<p>La méthode <code data-pkg="stats" data-rdoc="predict.glm">predict</code> avec l’argument <code>type="response"</code> permet d’appliquer notre modèle logistique à un tableau de données et renvoie pour chaque individu la probabilité qu’il ait vécu le phénomène étudié.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1">sport.pred &lt;-<span class="st"> </span><span class="kw">predict</span>(reg, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>, <span class="dt">newdata =</span> d)</a>
<a class="sourceLine" id="cb50-2" title="2"><span class="kw">head</span>(sport.pred)</a></code></pre></div>
<pre><code>         1          2          3          4          5 
0.61241192 0.73414575 0.15982958 0.70350157 0.07293505 
         6 
0.34824228 </code></pre>
<p>Or notre variable étudiée est de type binaire. Nous devons donc transformer nos probabilités prédites en une variable du type « oui / non ». Usuellement, les probabilités prédites seront réunies en deux groupes selon qu’elles soient supérieures ou inférieures à la moitié. La matrice de confusion est alors égale à :</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1"><span class="kw">table</span>(sport.pred <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>, d<span class="op">$</span>sport)</a></code></pre></div>
<pre><code>       
         Non  Oui
  FALSE 1076  384
  TRUE   199  336</code></pre>
<p>Nous avons donc 583 (384+199) prédictions incorrectes sur un total de 1993, soit un taux de mauvais classement de 29,3 %.</p>
</div>
<div id="identifier-les-variables-ayant-un-effet-significatif" class="section level3">
<h3>Identifier les variables ayant un effet significatif</h3>
<p>Les p-values associées aux odds ratios nous indique si un odd ratio est significativement différent de 1, par rapport à la modalité de référebce. Mais cela n’indique pas si globalement une variable a un effet significatif sur le modèle. Pour tester l’effet global sur un modèle, on peut avoir recours à la fonction <code data-pkg="stats">drop1</code>. Cette dernière va tour à tour supprimer chaque variable du modèle et réaliser une analyse de variance (ANOVA, voir fonction <code data-pkg="stats">anova</code>) pour voir si la variance change significativement.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="kw">drop1</span>(reg, <span class="dt">test =</span> <span class="st">&quot;Chisq&quot;</span>)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["LRT"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"NA","2":"2206.173","3":"2236.173","4":"NA","5":"NA","_rn_":"<none>"},{"1":"1","2":"2223.482","3":"2251.482","4":"17.309362","5":"3.176182e-05","_rn_":"sexe"},{"1":"3","2":"2258.975","3":"2282.975","4":"52.802551","5":"2.019958e-11","_rn_":"grpage"},{"1":"4","2":"2329.999","3":"2351.999","4":"123.826250","5":"8.132287e-26","_rn_":"etud"},{"1":"5","2":"2210.404","3":"2230.404","4":"4.231856","5":"5.165401e-01","_rn_":"relig"},{"1":"1","2":"2219.611","3":"2247.611","4":"13.438488","5":"2.465142e-04","_rn_":"heures.tv"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Ainsi, dans le cas présent, la suppression de la variable <var>relig</var> ne modifie significativement pas le modèle, indiquant l’absence d’effet de cette variable.</p>
</div>
<div id="selection-de-modeles" class="section level3">
<h3>Sélection de modèles</h3>
<p>Il est toujours tentant lorsque l’on recherche les facteurs associés à un phénomène d’inclure un nombre important de variables explicatives potentielles dans un mmodèle logistique. Cependant, un tel modèle n’est pas forcément le plus efficace et certaines variables n’auront probablement pas d’effet significatif sur la variable d’intérêt.</p>
<p>La technique de <dfn>sélection descendante pas à pas</dfn><dfn data-index="pas à pas, sélection descendante"></dfn> est une approche visant à améliorer son modèle explicatif<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>. On réalise un premier modèle avec toutes les variables spécifiées, puis on regarde s’il est possible d’améliorer le modèle en supprimant une des variables du modèle. Si plusieurs variables permettent d’améliorer le modèle, on supprimera la variable dont la suppression améliorera le plus le modèle. Puis on recommence le même procédé pour voir si la suppression d’une seconde variable peut encore améliorer le modèle et ainsi de suite. Lorsque le modèle ne peut plus être améliorer par la suppresion d’une variable, on s’arrête.</p>
<p>Il faut également définir un critère pour déterminer la qualité d’un modèle. L’un des plus utilisés est le <dfn lang="en">Akaike Information Criterion</dfn> ou <dfn>AIC</dfn>. Plus l’AIC sera faible, meilleure sera le modèle.</p>
<p>La fonction <code data-pkg="stats">step</code> permet justement de sélectionner le meilleur modèle par une procédure pas à pas descendante basée sur la minimisation de l’AIC. La fonction affiche à l’écran les différentes étapes de la sélection et renvoie le modèle final.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1">reg2 &lt;-<span class="st"> </span><span class="kw">step</span>(reg)</a></code></pre></div>
<pre><code>Start:  AIC=2236.17
sport ~ sexe + grpage + etud + relig + heures.tv

            Df Deviance    AIC
- relig      5   2210.4 2230.4
&lt;none&gt;           2206.2 2236.2
- heures.tv  1   2219.6 2247.6
- sexe       1   2223.5 2251.5
- grpage     3   2259.0 2283.0
- etud       4   2330.0 2352.0

Step:  AIC=2230.4
sport ~ sexe + grpage + etud + heures.tv

            Df Deviance    AIC
&lt;none&gt;           2210.4 2230.4
- heures.tv  1   2224.0 2242.0
- sexe       1   2226.4 2244.4
- grpage     3   2260.6 2274.6
- etud       4   2334.3 2346.3</code></pre>
<p>Le modèle initial a un AIC de 2235,9. À la première étape, il apparait que la suppression de la variable religion permet diminuer l’AIC à 2230,2. Lors de la seconde étape, toute suppression d’une autre variable ferait augmenter l’AIC. La procédure s’arrête donc.</p>
<p>Pour obtenir directement l’AIC d’un modèle donné, on peut utiliser la fonction <code data-pkg="stats">AIC</code>.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="kw">AIC</span>(reg)</a></code></pre></div>
<pre><code>[1] 2236.173</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"><span class="kw">AIC</span>(reg2)</a></code></pre></div>
<pre><code>[1] 2230.404</code></pre>
<p>On peut effectuer une <dfn>analyse de variance</dfn><dfn data-index="variance, analyse de"></dfn> ou <dfn lang="en">ANOVA</dfn> pour comparer les deux modèles avec la fonction <code data-pkg="stats">anova</code>.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="kw">anova</span>(reg, reg2, <span class="dt">test =</span> <span class="st">&quot;Chisq&quot;</span>)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Resid. Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Resid. Dev"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"1980","2":"2206.173","3":"NA","4":"NA","5":"NA","_rn_":"1"},{"1":"1985","2":"2210.404","3":"-5","4":"-4.231856","5":"0.5165401","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Il n’y a pas de différences significatives entre nos deux modèles. Autrement dit, notre second modèle explique tout autant de variance que notre premier modèle, tout en étant plus parcimonieux.</p>
<div class="note">
<p>Une alternative à la fonction <code data-pkg="stats">step</code> est la fonction <code data-pkg="MASS">stepAIC</code> de l’extension <code class="pkg">MASS</code> qui fonctionne de la même manière. Si cela ne change rien aux régressions logistiques classiques, il arrive que pour certains types de modèle la méthode <code data-pkg="stats">step</code> ne soit pas disponible, mais que <code data-pkg="MASS">stepAIC</code> puisse être utilisée à la place.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1"><span class="kw">library</span>(MASS)</a>
<a class="sourceLine" id="cb62-2" title="2">reg2bis &lt;-<span class="st"> </span><span class="kw">stepAIC</span>(reg)</a></code></pre></div>
<pre><code>Start:  AIC=2236.17
sport ~ sexe + grpage + etud + relig + heures.tv

            Df Deviance    AIC
- relig      5   2210.4 2230.4
&lt;none&gt;           2206.2 2236.2
- heures.tv  1   2219.6 2247.6
- sexe       1   2223.5 2251.5
- grpage     3   2259.0 2283.0
- etud       4   2330.0 2352.0

Step:  AIC=2230.4
sport ~ sexe + grpage + etud + heures.tv

            Df Deviance    AIC
&lt;none&gt;           2210.4 2230.4
- heures.tv  1   2224.0 2242.0
- sexe       1   2226.4 2244.4
- grpage     3   2260.6 2274.6
- etud       4   2334.3 2346.3</code></pre>
</div>
</div>
<div id="tableaux-all-in-one" class="section level3">
<h3>Tableaux <q>all-in-one</q></h3>
<p>L’extension <code class="pkg">finalfit</code> fournit une fonction <code data-pkg="finalfit">finalfit</code> du type <q lang="en">all-in-one</q> qui calcule un tableau avec les tris croisés, les odds ratios univariés et un modèle multivarié.</p>
<p>Il faut d’abord définir la variable dépendante et les variables explicatives.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1">dep &lt;-<span class="st"> &quot;sport&quot;</span></a>
<a class="sourceLine" id="cb64-2" title="2">vars &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;sexe&quot;</span>, <span class="st">&quot;grpage&quot;</span>, <span class="st">&quot;etud&quot;</span>, <span class="st">&quot;relig&quot;</span>, <span class="st">&quot;heures.tv&quot;</span>)</a></code></pre></div>
<p>Une première fonction <code data-pkg="finalfit">summary_factorlist</code> fournit un tableau descriptif avec, si l’option <code>p  = TRUE</code> est indiquée, des tests de comparaisons (ici des tests du Chi²).</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="kw">library</span>(finalfit)</a>
<a class="sourceLine" id="cb65-2" title="2">tab &lt;-<span class="st"> </span><span class="kw">summary_factorlist</span>(d, dep, vars, <span class="dt">p =</span> <span class="ot">TRUE</span>, <span class="dt">add_dependent_label =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb65-3" title="3">tab</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Dependent: Pratique du sport ?"],"name":[1],"type":["chr"],"align":["left"]},{"label":[""],"name":[2],"type":["chr"],"align":["left"]},{"label":["Non"],"name":[3],"type":["chr"],"align":["left"]},{"label":["Oui"],"name":[4],"type":["chr"],"align":["left"]},{"label":["p"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"Sexe","2":"Femme","3":"747 (67.8)","4":"354 (32.2)","5":"<0.001","_rn_":"17"},{"1":"","2":"Homme","3":"530 (59.0)","4":"369 (41.0)","5":"","_rn_":"18"},{"1":"Groupe d'âges","2":"[16,25)","3":"58 (34.3)","4":"111 (65.7)","5":"<0.001","_rn_":"6"},{"1":"","2":"[25,45)","3":"359 (50.8)","4":"347 (49.2)","5":"","_rn_":"7"},{"1":"","2":"[45,65)","3":"541 (72.6)","4":"204 (27.4)","5":"","_rn_":"8"},{"1":"","2":"[65,99]","3":"319 (83.9)","4":"61 (16.1)","5":"","_rn_":"9"},{"1":"Niveau d'étude","2":"Primaire","3":"416 (89.3)","4":"50 (10.7)","5":"<0.001","_rn_":"1"},{"1":"","2":"Secondaire","3":"270 (69.8)","4":"117 (30.2)","5":"","_rn_":"2"},{"1":"","2":"Technique/Professionnel","3":"378 (63.6)","4":"216 (36.4)","5":"","_rn_":"3"},{"1":"","2":"Supérieur","3":"186 (42.2)","4":"255 (57.8)","5":"","_rn_":"4"},{"1":"","2":"manquant","3":"27 (24.1)","4":"85 (75.9)","5":"","_rn_":"5"},{"1":"Pratique religieuse","2":"Pratiquant regulier","3":"182 (68.4)","4":"84 (31.6)","5":"0.144","_rn_":"11"},{"1":"","2":"Pratiquant occasionnel","3":"295 (66.7)","4":"147 (33.3)","5":"","_rn_":"12"},{"1":"","2":"Appartenance sans pratique","3":"473 (62.2)","4":"287 (37.8)","5":"","_rn_":"13"},{"1":"","2":"Ni croyance ni appartenance","3":"239 (59.9)","4":"160 (40.1)","5":"","_rn_":"14"},{"1":"","2":"Rejet","3":"60 (64.5)","4":"33 (35.5)","5":"","_rn_":"15"},{"1":"","2":"NSP ou NVPR","3":"28 (70.0)","4":"12 (30.0)","5":"","_rn_":"16"},{"1":"Nombre d'heures passées devant la télévision par jour","2":"Mean (SD)","3":"2.5 (1.9)","4":"1.8 (1.4)","5":"<0.001","_rn_":"10"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>On peut remarquer que <code class="pkg">finalfit</code> a tenu compte des étiquettes de variables définies plus haut avec <code data-pkg="labelled">var_label</code> de l’extension <code class="pkg">labelled</code> (voir le <a href="facteurs-et-vecteurs-labellises.html#les-etiquettes-de-variable">chapitre sur les vecteurs labellisés</a>).</p>
<p>On peut associer le résultat avec la fonction <code data-pkg="knitr">kable</code> de <code class="pkg">knitr</code> pour un rendu plus esthétique lorsque l’on produit un rapport <strong>Rmarkdown</strong> (voir le <a href="rmarkdown-les-rapports-automatises.html">chapitre dédié aux rapports automatisés</a>).</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1">knitr<span class="op">::</span><span class="kw">kable</span>(tab, <span class="dt">row.names =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Dependent: Pratique du sport ?</th>
<th></th>
<th align="left">Non</th>
<th align="left">Oui</th>
<th align="left">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Sexe</td>
<td>Femme</td>
<td align="left">747 (67.8)</td>
<td align="left">354 (32.2)</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="even">
<td align="left"></td>
<td>Homme</td>
<td align="left">530 (59.0)</td>
<td align="left">369 (41.0)</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Groupe d’âges</td>
<td>[16,25)</td>
<td align="left">58 (34.3)</td>
<td align="left">111 (65.7)</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="even">
<td align="left"></td>
<td>[25,45)</td>
<td align="left">359 (50.8)</td>
<td align="left">347 (49.2)</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td>[45,65)</td>
<td align="left">541 (72.6)</td>
<td align="left">204 (27.4)</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"></td>
<td>[65,99]</td>
<td align="left">319 (83.9)</td>
<td align="left">61 (16.1)</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Niveau d’étude</td>
<td>Primaire</td>
<td align="left">416 (89.3)</td>
<td align="left">50 (10.7)</td>
<td align="left">&lt;0.001</td>
</tr>
<tr class="even">
<td align="left"></td>
<td>Secondaire</td>
<td align="left">270 (69.8)</td>
<td align="left">117 (30.2)</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td>Technique/Professionnel</td>
<td align="left">378 (63.6)</td>
<td align="left">216 (36.4)</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"></td>
<td>Supérieur</td>
<td align="left">186 (42.2)</td>
<td align="left">255 (57.8)</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td>manquant</td>
<td align="left">27 (24.1)</td>
<td align="left">85 (75.9)</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Pratique religieuse</td>
<td>Pratiquant regulier</td>
<td align="left">182 (68.4)</td>
<td align="left">84 (31.6)</td>
<td align="left">0.144</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td>Pratiquant occasionnel</td>
<td align="left">295 (66.7)</td>
<td align="left">147 (33.3)</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"></td>
<td>Appartenance sans pratique</td>
<td align="left">473 (62.2)</td>
<td align="left">287 (37.8)</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td>Ni croyance ni appartenance</td>
<td align="left">239 (59.9)</td>
<td align="left">160 (40.1)</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"></td>
<td>Rejet</td>
<td align="left">60 (64.5)</td>
<td align="left">33 (35.5)</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td>NSP ou NVPR</td>
<td align="left">28 (70.0)</td>
<td align="left">12 (30.0)</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Nombre d’heures passées devant la télévision par jour</td>
<td>Mean (SD)</td>
<td align="left">2.5 (1.9)</td>
<td align="left">1.8 (1.4)</td>
<td align="left">&lt;0.001</td>
</tr>
</tbody>
</table>
<p>La fonction <code data-pkg="finalfit">finalfit</code>, quant à elle, calcule à la fois les <em>odds ratios</em> univariés (modèles logistiques avec une seule variable inclue à la fois) et un modèle complet, présentant le tout dans un tableau synthétique.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1">tab &lt;-<span class="st"> </span><span class="kw">finalfit</span>(d, dep, vars)</a>
<a class="sourceLine" id="cb67-2" title="2">knitr<span class="op">::</span><span class="kw">kable</span>(tab, <span class="dt">row.names =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Dependent: Pratique du sport ?</th>
<th></th>
<th align="left">Non</th>
<th align="left">Oui</th>
<th align="left">OR (univariable)</th>
<th align="left">OR (multivariable)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Sexe</td>
<td>Femme</td>
<td align="left">747 (58.5)</td>
<td align="left">354 (49.0)</td>
<td align="left">-</td>
<td align="left">-</td>
</tr>
<tr class="even">
<td align="left"></td>
<td>Homme</td>
<td align="left">530 (41.5)</td>
<td align="left">369 (51.0)</td>
<td align="left">1.47 (1.22-1.77, p&lt;0.001)</td>
<td align="left">1.55 (1.26-1.91, p&lt;0.001)</td>
</tr>
<tr class="odd">
<td align="left">Groupe d’âges</td>
<td>[16,25)</td>
<td align="left">58 (4.5)</td>
<td align="left">111 (15.4)</td>
<td align="left">-</td>
<td align="left">-</td>
</tr>
<tr class="even">
<td align="left"></td>
<td>[25,45)</td>
<td align="left">359 (28.1)</td>
<td align="left">347 (48.0)</td>
<td align="left">0.51 (0.35-0.71, p&lt;0.001)</td>
<td align="left">0.66 (0.42-1.03, p=0.065)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td>[45,65)</td>
<td align="left">541 (42.4)</td>
<td align="left">204 (28.2)</td>
<td align="left">0.20 (0.14-0.28, p&lt;0.001)</td>
<td align="left">0.34 (0.21-0.54, p&lt;0.001)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td>[65,99]</td>
<td align="left">319 (25.0)</td>
<td align="left">61 (8.4)</td>
<td align="left">0.10 (0.07-0.15, p&lt;0.001)</td>
<td align="left">0.25 (0.15-0.43, p&lt;0.001)</td>
</tr>
<tr class="odd">
<td align="left">Niveau d’étude</td>
<td>Primaire</td>
<td align="left">416 (32.6)</td>
<td align="left">50 (6.9)</td>
<td align="left">-</td>
<td align="left">-</td>
</tr>
<tr class="even">
<td align="left"></td>
<td>Secondaire</td>
<td align="left">270 (21.1)</td>
<td align="left">117 (16.2)</td>
<td align="left">3.61 (2.52-5.23, p&lt;0.001)</td>
<td align="left">2.59 (1.77-3.83, p&lt;0.001)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td>Technique/Professionnel</td>
<td align="left">378 (29.6)</td>
<td align="left">216 (29.9)</td>
<td align="left">4.75 (3.42-6.72, p&lt;0.001)</td>
<td align="left">2.86 (1.98-4.17, p&lt;0.001)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td>Supérieur</td>
<td align="left">186 (14.6)</td>
<td align="left">255 (35.3)</td>
<td align="left">11.41 (8.11-16.31, p&lt;0.001)</td>
<td align="left">6.63 (4.55-9.80, p&lt;0.001)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td>manquant</td>
<td align="left">27 (2.1)</td>
<td align="left">85 (11.8)</td>
<td align="left">26.19 (15.74-44.90, p&lt;0.001)</td>
<td align="left">8.59 (4.53-16.59, p&lt;0.001)</td>
</tr>
<tr class="even">
<td align="left">Pratique religieuse</td>
<td>Pratiquant regulier</td>
<td align="left">182 (14.3)</td>
<td align="left">84 (11.6)</td>
<td align="left">-</td>
<td align="left">-</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td>Pratiquant occasionnel</td>
<td align="left">295 (23.1)</td>
<td align="left">147 (20.3)</td>
<td align="left">1.08 (0.78-1.50, p=0.644)</td>
<td align="left">0.98 (0.68-1.42, p=0.908)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td>Appartenance sans pratique</td>
<td align="left">473 (37.0)</td>
<td align="left">287 (39.7)</td>
<td align="left">1.31 (0.98-1.78, p=0.071)</td>
<td align="left">0.99 (0.71-1.40, p=0.969)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td>Ni croyance ni appartenance</td>
<td align="left">239 (18.7)</td>
<td align="left">160 (22.1)</td>
<td align="left">1.45 (1.05-2.02, p=0.026)</td>
<td align="left">0.81 (0.55-1.18, p=0.265)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td>Rejet</td>
<td align="left">60 (4.7)</td>
<td align="left">33 (4.6)</td>
<td align="left">1.19 (0.72-1.95, p=0.489)</td>
<td align="left">0.68 (0.39-1.19, p=0.180)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td>NSP ou NVPR</td>
<td align="left">28 (2.2)</td>
<td align="left">12 (1.7)</td>
<td align="left">0.93 (0.44-1.88, p=0.841)</td>
<td align="left">0.92 (0.40-2.02, p=0.838)</td>
</tr>
<tr class="even">
<td align="left">Nombre d’heures passées devant la télévision par jour</td>
<td>Mean (SD)</td>
<td align="left">2.5 (1.9)</td>
<td align="left">1.8 (1.4)</td>
<td align="left">0.79 (0.74-0.84, p&lt;0.001)</td>
<td align="left">0.89 (0.83-0.95, p&lt;0.001)</td>
</tr>
</tbody>
</table>
<p>Par défaut, toutes les variables explicatives fournies sont retenues dans le modèle affiché. Si on ne souhaite inclure que certaines variables dans le modèle mutivarié (parce que l’on aura précédemment réalisé une procédure <code data-pkg="stats">step</code>), il faudra préciser séparément les variables du modèle multivarié.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1">vars_multi &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;sexe&quot;</span>, <span class="st">&quot;grpage&quot;</span>, <span class="st">&quot;etud&quot;</span>, <span class="st">&quot;heures.tv&quot;</span>)</a>
<a class="sourceLine" id="cb68-2" title="2">tab &lt;-<span class="st"> </span><span class="kw">finalfit</span>(d, dep, vars, <span class="dt">explanatory_multi =</span> vars_multi)</a>
<a class="sourceLine" id="cb68-3" title="3">knitr<span class="op">::</span><span class="kw">kable</span>(tab, <span class="dt">row.names =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Dependent: Pratique du sport ?</th>
<th></th>
<th align="left">Non</th>
<th align="left">Oui</th>
<th align="left">OR (univariable)</th>
<th align="left">OR (multivariable)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Sexe</td>
<td>Femme</td>
<td align="left">747 (58.5)</td>
<td align="left">354 (49.0)</td>
<td align="left">-</td>
<td align="left">-</td>
</tr>
<tr class="even">
<td align="left"></td>
<td>Homme</td>
<td align="left">530 (41.5)</td>
<td align="left">369 (51.0)</td>
<td align="left">1.47 (1.22-1.77, p&lt;0.001)</td>
<td align="left">1.52 (1.24-1.87, p&lt;0.001)</td>
</tr>
<tr class="odd">
<td align="left">Groupe d’âges</td>
<td>[16,25)</td>
<td align="left">58 (4.5)</td>
<td align="left">111 (15.4)</td>
<td align="left">-</td>
<td align="left">-</td>
</tr>
<tr class="even">
<td align="left"></td>
<td>[25,45)</td>
<td align="left">359 (28.1)</td>
<td align="left">347 (48.0)</td>
<td align="left">0.51 (0.35-0.71, p&lt;0.001)</td>
<td align="left">0.68 (0.43-1.06, p=0.084)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td>[45,65)</td>
<td align="left">541 (42.4)</td>
<td align="left">204 (28.2)</td>
<td align="left">0.20 (0.14-0.28, p&lt;0.001)</td>
<td align="left">0.36 (0.23-0.57, p&lt;0.001)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td>[65,99]</td>
<td align="left">319 (25.0)</td>
<td align="left">61 (8.4)</td>
<td align="left">0.10 (0.07-0.15, p&lt;0.001)</td>
<td align="left">0.27 (0.16-0.46, p&lt;0.001)</td>
</tr>
<tr class="odd">
<td align="left">Niveau d’étude</td>
<td>Primaire</td>
<td align="left">416 (32.6)</td>
<td align="left">50 (6.9)</td>
<td align="left">-</td>
<td align="left">-</td>
</tr>
<tr class="even">
<td align="left"></td>
<td>Secondaire</td>
<td align="left">270 (21.1)</td>
<td align="left">117 (16.2)</td>
<td align="left">3.61 (2.52-5.23, p&lt;0.001)</td>
<td align="left">2.54 (1.73-3.75, p&lt;0.001)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td>Technique/Professionnel</td>
<td align="left">378 (29.6)</td>
<td align="left">216 (29.9)</td>
<td align="left">4.75 (3.42-6.72, p&lt;0.001)</td>
<td align="left">2.81 (1.95-4.10, p&lt;0.001)</td>
</tr>
<tr class="even">
<td align="left"></td>
<td>Supérieur</td>
<td align="left">186 (14.6)</td>
<td align="left">255 (35.3)</td>
<td align="left">11.41 (8.11-16.31, p&lt;0.001)</td>
<td align="left">6.55 (4.50-9.66, p&lt;0.001)</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td>manquant</td>
<td align="left">27 (2.1)</td>
<td align="left">85 (11.8)</td>
<td align="left">26.19 (15.74-44.90, p&lt;0.001)</td>
<td align="left">8.54 (4.51-16.47, p&lt;0.001)</td>
</tr>
<tr class="even">
<td align="left">Pratique religieuse</td>
<td>Pratiquant regulier</td>
<td align="left">182 (14.3)</td>
<td align="left">84 (11.6)</td>
<td align="left">-</td>
<td align="left">-</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td>Pratiquant occasionnel</td>
<td align="left">295 (23.1)</td>
<td align="left">147 (20.3)</td>
<td align="left">1.08 (0.78-1.50, p=0.644)</td>
<td align="left">-</td>
</tr>
<tr class="even">
<td align="left"></td>
<td>Appartenance sans pratique</td>
<td align="left">473 (37.0)</td>
<td align="left">287 (39.7)</td>
<td align="left">1.31 (0.98-1.78, p=0.071)</td>
<td align="left">-</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td>Ni croyance ni appartenance</td>
<td align="left">239 (18.7)</td>
<td align="left">160 (22.1)</td>
<td align="left">1.45 (1.05-2.02, p=0.026)</td>
<td align="left">-</td>
</tr>
<tr class="even">
<td align="left"></td>
<td>Rejet</td>
<td align="left">60 (4.7)</td>
<td align="left">33 (4.6)</td>
<td align="left">1.19 (0.72-1.95, p=0.489)</td>
<td align="left">-</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td>NSP ou NVPR</td>
<td align="left">28 (2.2)</td>
<td align="left">12 (1.7)</td>
<td align="left">0.93 (0.44-1.88, p=0.841)</td>
<td align="left">-</td>
</tr>
<tr class="even">
<td align="left">Nombre d’heures passées devant la télévision par jour</td>
<td>Mean (SD)</td>
<td align="left">2.5 (1.9)</td>
<td align="left">1.8 (1.4)</td>
<td align="left">0.79 (0.74-0.84, p&lt;0.001)</td>
<td align="left">0.89 (0.83-0.95, p&lt;0.001)</td>
</tr>
</tbody>
</table>
<p>On pourra se référer à l’aide de la fonction <code data-pkg="finalfit">finalfit</code> pour d’autres exemples.</p>
<p>L’extension <code class="pkg">finalfit</code> propose aussi une fonction <code data-pkg="finalfilt">or_plot</code> pour présenter les odd ratios obtenus sous forme de graphique.</p>
<figure>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1"><span class="kw">var_label</span>(d<span class="op">$</span>heures.tv) &lt;-<span class="st"> &quot;Nombre d&#39;heures</span><span class="ch">\n</span><span class="st">de TV par jour&quot;</span></a>
<a class="sourceLine" id="cb69-2" title="2"><span class="kw">or_plot</span>(d, dep, vars_multi)</a></code></pre></div>
<pre><code>Waiting for profiling to be done...
Waiting for profiling to be done...
Waiting for profiling to be done...</code></pre>
<pre><code>Warning: Removed 3 rows containing missing values
(geom_errorbarh).</code></pre>
<img src="graphs/regression-logistique/unnamed-chunk-39-1.png" width="1800" />
<figcaption>
Graphique des odds ratios obtenu avec or_plot
</figcaption>
</figure>
<p><strong>ATTENTION :</strong> <code data-pkg="final_fit">or_plot</code> n’est pas compatible avec les effets d’interactions (cf. ci-dessous).</p>
</div>
<div id="effets-dinteraction-dans-le-modele" class="section level3">
<h3>Effets d’interaction dans le modèle</h3>
<p>Voir le <a href="effets-d-interaction.html">chapitre dédié aux effets d’interaction</a>.</p>
</div>
<div id="multicolinearite" class="section level3">
<h3>Multicolinéarité</h3>
<p>Voir le <a href="multicolinearite.html">chapitre dédié</a>.</p>
</div>
</div>
<div id="regression-logistique-multinomiale" class="section level2">
<h2>Régression logistique multinomiale</h2>
<p>La <dfn>régression logistique multinomiale</dfn><dfn data-index="multinomiale, régression logistique"></dfn> est une extension de la régression logistique aux variables qualitatives à trois modalités ou plus. Dans ce cas de figure, chaque modalité de la variable d’intérêt sera comparée à la modalité de réference. Les <em>odds ratio</em> seront donc exprimés par rapport à cette dernière.</p>
<p>Nous allons prendre pour exemple la variable <em>trav.satisf</em>, à savoir la satisfaction ou l’insatisfaction au travail.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1"><span class="kw">freq</span>(d<span class="op">$</span>trav.satisf)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["n"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["%"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["val%"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"480","2":"24.0","3":"45.8","_rn_":"Satisfaction"},{"1":"117","2":"5.9","3":"11.2","_rn_":"Insatisfaction"},{"1":"451","2":"22.6","3":"43.0","_rn_":"Equilibre"},{"1":"952","2":"47.6","3":"NA","_rn_":"__NA__"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Nous allons choisir comme modalité de référence la position intermédiaire, à savoir l’« équilibre ».</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1">d<span class="op">$</span>trav.satisf &lt;-<span class="st"> </span><span class="kw">relevel</span>(d<span class="op">$</span>trav.satisf, <span class="st">&quot;Equilibre&quot;</span>)</a></code></pre></div>
<p>Enfin, nous allons aussi en profiter pour raccourcir les étiquettes de la variable <em>trav.imp</em> :</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1"><span class="kw">levels</span>(d<span class="op">$</span>trav.imp) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Le plus&quot;</span>, <span class="st">&quot;Aussi&quot;</span>, <span class="st">&quot;Moins&quot;</span>, <span class="st">&quot;Peu&quot;</span>)</a></code></pre></div>
<p>Pour calculer un modèle logistique multinomial, nous allons utiliser la fonction <code data-pkg="nnet">multinom</code> de l’extension <code class="pkg">nnet</code><a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>. La syntaxe de <code data-pkg="nnet">multinom</code> est similaire à celle de <code data-pkg="stats">glm</code>, le paramètre <code>family</code> en moins.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1"><span class="kw">library</span>(nnet)</a>
<a class="sourceLine" id="cb75-2" title="2">regm &lt;-<span class="st"> </span><span class="kw">multinom</span>(trav.satisf <span class="op">~</span><span class="st"> </span>sexe <span class="op">+</span><span class="st"> </span>etud <span class="op">+</span><span class="st"> </span>grpage <span class="op">+</span><span class="st"> </span>trav.imp, </a>
<a class="sourceLine" id="cb75-3" title="3">  <span class="dt">data =</span> d)</a></code></pre></div>
<pre><code># weights:  39 (24 variable)
initial  value 1151.345679 
iter  10 value 977.348901
iter  20 value 969.849189
iter  30 value 969.522965
final  value 969.521855 
converged</code></pre>
<p>Comme pour la régression logistique, il est possible de réaliser une sélection pas à pas descendante :</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1">regm2 &lt;-<span class="st"> </span><span class="kw">step</span>(regm)</a></code></pre></div>
<pre><code>Start:  AIC=1987.04
trav.satisf ~ sexe + etud + grpage + trav.imp

trying - sexe 
# weights:  36 (22 variable)
initial  value 1151.345679 
iter  10 value 978.538886
iter  20 value 970.453555
iter  30 value 970.294459
final  value 970.293988 
converged
trying - etud 
# weights:  27 (16 variable)
initial  value 1151.345679 
iter  10 value 987.907714
iter  20 value 981.785467
iter  30 value 981.762800
final  value 981.762781 
converged
trying - grpage 
# weights:  30 (18 variable)
initial  value 1151.345679 
iter  10 value 979.485430
iter  20 value 973.175923
final  value 973.172389 
converged
trying - trav.imp 
# weights:  30 (18 variable)
initial  value 1151.345679 
iter  10 value 998.803976
iter  20 value 994.417973
iter  30 value 994.378914
final  value 994.378869 
converged
           Df      AIC
- grpage   18 1982.345
- sexe     22 1984.588
&lt;none&gt;     24 1987.044
- etud     16 1995.526
- trav.imp 18 2024.758
# weights:  30 (18 variable)
initial  value 1151.345679 
iter  10 value 979.485430
iter  20 value 973.175923
final  value 973.172389 
converged

Step:  AIC=1982.34
trav.satisf ~ sexe + etud + trav.imp

trying - sexe 
# weights:  27 (16 variable)
initial  value 1151.345679 
iter  10 value 976.669670
iter  20 value 973.928385
iter  20 value 973.928377
iter  20 value 973.928377
final  value 973.928377 
converged
trying - etud 
# weights:  18 (10 variable)
initial  value 1151.345679 
iter  10 value 988.413720
final  value 985.085797 
converged
trying - trav.imp 
# weights:  21 (12 variable)
initial  value 1151.345679 
iter  10 value 1001.517287
final  value 998.204280 
converged
           Df      AIC
- sexe     16 1979.857
&lt;none&gt;     18 1982.345
- etud     10 1990.172
- trav.imp 12 2020.409
# weights:  27 (16 variable)
initial  value 1151.345679 
iter  10 value 976.669670
iter  20 value 973.928385
iter  20 value 973.928377
iter  20 value 973.928377
final  value 973.928377 
converged

Step:  AIC=1979.86
trav.satisf ~ etud + trav.imp

trying - etud 
# weights:  15 (8 variable)
initial  value 1151.345679 
iter  10 value 986.124104
final  value 986.034023 
converged
trying - trav.imp 
# weights:  18 (10 variable)
initial  value 1151.345679 
iter  10 value 1000.225356
final  value 998.395273 
converged
           Df      AIC
&lt;none&gt;     16 1979.857
- etud      8 1988.068
- trav.imp 10 2016.791</code></pre>
<p>La plupart des fonctions vues précédemment fonctionnent :</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1"><span class="kw">summary</span>(regm2)</a></code></pre></div>
<pre><code>Call:
multinom(formula = trav.satisf ~ etud + trav.imp, data = d)

Coefficients:
               (Intercept) etudSecondaire
Satisfaction    -0.1110996     0.04916210
Insatisfaction  -1.1213760    -0.09737523
               etudTechnique/Professionnel etudSupérieur
Satisfaction                    0.07793241    0.69950061
Insatisfaction                  0.08392603    0.07755307
               etudmanquant trav.impAussi trav.impMoins
Satisfaction    -0.53841577     0.2578973    -0.1756206
Insatisfaction  -0.04364055    -0.2279774    -0.5330349
               trav.impPeu
Satisfaction    -0.5995051
Insatisfaction   1.3401509

Std. Errors:
               (Intercept) etudSecondaire
Satisfaction     0.4520902      0.2635573
Insatisfaction   0.6516992      0.3999875
               etudTechnique/Professionnel etudSupérieur
Satisfaction                     0.2408483     0.2472571
Insatisfaction                   0.3579684     0.3831110
               etudmanquant trav.impAussi trav.impMoins
Satisfaction      0.5910993     0.4260623     0.4115818
Insatisfaction    0.8407592     0.6213781     0.5941721
               trav.impPeu
Satisfaction     0.5580115
Insatisfaction   0.6587383

Residual Deviance: 1947.857 
AIC: 1979.857 </code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1"><span class="kw">odds.ratio</span>(regm2)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["OR"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["2.5 %"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["97.5 %"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["p"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.8948496","2":"0.36891824","3":"2.170551","4":"0.805878421","_rn_":"Satisfaction/(Intercept)"},{"1":"1.0503906","2":"0.62662899","3":"1.760724","4":"0.852026888","_rn_":"Satisfaction/etudSecondaire"},{"1":"1.0810496","2":"0.67427204","3":"1.733230","4":"0.746260102","_rn_":"Satisfaction/etudTechnique/Professionnel"},{"1":"2.0127473","2":"1.23972010","3":"3.267795","4":"0.004668761","_rn_":"Satisfaction/etudSupérieur"},{"1":"0.5836722","2":"0.18324174","3":"1.859146","4":"0.362362820","_rn_":"Satisfaction/etudmanquant"},{"1":"1.2942058","2":"0.56148541","3":"2.983103","4":"0.544976949","_rn_":"Satisfaction/trav.impAussi"},{"1":"0.8389362","2":"0.37444660","3":"1.879611","4":"0.669600230","_rn_":"Satisfaction/trav.impMoins"},{"1":"0.5490833","2":"0.18393230","3":"1.639149","4":"0.282661454","_rn_":"Satisfaction/trav.impPeu"},{"1":"0.3258311","2":"0.09083751","3":"1.168745","4":"0.085306052","_rn_":"Insatisfaction/(Intercept)"},{"1":"0.9072155","2":"0.41422897","3":"1.986920","4":"0.807660187","_rn_":"Insatisfaction/etudSecondaire"},{"1":"1.0875484","2":"0.53919437","3":"2.193572","4":"0.814634911","_rn_":"Insatisfaction/etudTechnique/Professionnel"},{"1":"1.0806396","2":"0.51000705","3":"2.289737","4":"0.839580764","_rn_":"Insatisfaction/etudSupérieur"},{"1":"0.9572980","2":"0.18424328","3":"4.973964","4":"0.958603498","_rn_":"Insatisfaction/etudmanquant"},{"1":"0.7961422","2":"0.23554433","3":"2.690969","4":"0.713701054","_rn_":"Insatisfaction/trav.impAussi"},{"1":"0.5868213","2":"0.18312418","3":"1.880469","4":"0.369662736","_rn_":"Insatisfaction/trav.impMoins"},{"1":"3.8196198","2":"1.05027036","3":"13.891181","4":"0.041909177","_rn_":"Insatisfaction/trav.impPeu"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>De même, il est possible de calculer la matrice de confusion :</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1"><span class="kw">table</span>(<span class="kw">predict</span>(regm2, <span class="dt">newdata =</span> d), d<span class="op">$</span>trav.satisf)</a></code></pre></div>
<pre><code>                
                 Equilibre Satisfaction Insatisfaction
  Equilibre            262          211             49
  Satisfaction         171          258             45
  Insatisfaction        18           11             23</code></pre>
<p>La fonction <code data-pkg="broom">tidy</code> peut s’appliquer au résultat de <code data-pkg="nnet">multinom</code> :</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="kw">library</span>(broom)</a>
<a class="sourceLine" id="cb84-2" title="2"><span class="kw">tidy</span>(regm2, <span class="dt">exponentiate =</span> <span class="ot">TRUE</span>, <span class="dt">conf.int =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["y.level"],"name":[1],"type":["chr"],"align":["left"]},{"label":["term"],"name":[2],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["conf.low"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["conf.high"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"Satisfaction","2":"(Intercept)","3":"0.8948496","4":"0.4520902","5":"-0.24574657","6":"0.805878421","7":"0.36891824","8":"2.170551"},{"1":"Satisfaction","2":"etudSecondaire","3":"1.0503906","4":"0.2635573","5":"0.18653289","6":"0.852026888","7":"0.62662899","8":"1.760724"},{"1":"Satisfaction","2":"etudTechnique/Professionnel","3":"1.0810496","4":"0.2408483","5":"0.32357462","6":"0.746260102","7":"0.67427204","8":"1.733230"},{"1":"Satisfaction","2":"etudSupérieur","3":"2.0127473","4":"0.2472571","5":"2.82904174","6":"0.004668761","7":"1.23972010","8":"3.267795"},{"1":"Satisfaction","2":"etudmanquant","3":"0.5836722","4":"0.5910993","5":"-0.91087200","6":"0.362362820","7":"0.18324174","8":"1.859146"},{"1":"Satisfaction","2":"trav.impAussi","3":"1.2942058","4":"0.4260623","5":"0.60530411","6":"0.544976949","7":"0.56148541","8":"2.983103"},{"1":"Satisfaction","2":"trav.impMoins","3":"0.8389362","4":"0.4115818","5":"-0.42669673","6":"0.669600230","7":"0.37444660","8":"1.879611"},{"1":"Satisfaction","2":"trav.impPeu","3":"0.5490833","4":"0.5580115","5":"-1.07435980","6":"0.282661454","7":"0.18393230","8":"1.639149"},{"1":"Insatisfaction","2":"(Intercept)","3":"0.3258311","4":"0.6516992","5":"-1.72069573","6":"0.085306052","7":"0.09083751","8":"1.168745"},{"1":"Insatisfaction","2":"etudSecondaire","3":"0.9072155","4":"0.3999875","5":"-0.24344565","6":"0.807660187","7":"0.41422897","8":"1.986920"},{"1":"Insatisfaction","2":"etudTechnique/Professionnel","3":"1.0875484","4":"0.3579684","5":"0.23445095","6":"0.814634911","7":"0.53919437","8":"2.193572"},{"1":"Insatisfaction","2":"etudSupérieur","3":"1.0806396","4":"0.3831110","5":"0.20242976","6":"0.839580764","7":"0.51000705","8":"2.289737"},{"1":"Insatisfaction","2":"etudmanquant","3":"0.9572980","4":"0.8407592","5":"-0.05190612","6":"0.958603498","7":"0.18424328","8":"4.973964"},{"1":"Insatisfaction","2":"trav.impAussi","3":"0.7961422","4":"0.6213781","5":"-0.36689002","6":"0.713701054","7":"0.23554433","8":"2.690969"},{"1":"Insatisfaction","2":"trav.impMoins","3":"0.5868213","4":"0.5941721","5":"-0.89710529","6":"0.369662736","7":"0.18312418","8":"1.880469"},{"1":"Insatisfaction","2":"trav.impPeu","3":"3.8196198","4":"0.6587383","5":"2.03442089","6":"0.041909177","7":"1.05027036","8":"13.891181"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>On notera la présence d’une colonne supplémentaire, <var>y.level</var>. De fait, la fonction <code data-pkg="GGally">ggcoef</code> ne peut s’appliquer directement, car les coefficients vont se supperposer.</p>
<figure>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1"><span class="kw">ggcoef</span>(regm2, <span class="dt">exponentiate =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<img src="graphs/regression-logistique/unnamed-chunk-48-1.png" width="1050" />
<figcaption>
À ne pas faire : appliquer directment ggcoef
</figcaption>
</figure>
<p>On a deux solutions possibles. Pour la première, la plus simple, il suffit d’ajouter des facettes avec <code data-pkg="ggplot2">facet_grid</code>.</p>
<figure>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"><span class="kw">ggcoef</span>(regm2, <span class="dt">exponentiate =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(<span class="op">~</span>y.level)</a></code></pre></div>
<img src="graphs/regression-logistique/unnamed-chunk-49-1.png" width="1050" />
<figcaption>
ggcoef avec facet_grid
</figcaption>
</figure>
<p>Pour la seconde, on va réaliser un graphique personnalisé, sur la même logique que <code data-pkg="GGally">ggcoef</code>, décalant les points grâce à <code data-pkg="ggplot2">position_dodge</code>.</p>
<figure>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1"><span class="kw">ggplot</span>(<span class="kw">tidy</span>(regm2, <span class="dt">exponentiate =</span> T, <span class="dt">conf.int =</span> <span class="ot">TRUE</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> term, </a>
<a class="sourceLine" id="cb87-2" title="2">  <span class="dt">y =</span> estimate, <span class="dt">ymin =</span> conf.low, <span class="dt">ymax =</span> conf.high, <span class="dt">color =</span> y.level) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb87-3" title="3"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;gray25&quot;</span>, <span class="dt">linetype =</span> <span class="st">&quot;dotted&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb87-4" title="4"><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="fl">0.5</span>), <span class="dt">width =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb87-5" title="5"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="fl">0.5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_log10</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb87-6" title="6"><span class="st">  </span><span class="kw">coord_flip</span>()</a></code></pre></div>
<img src="graphs/regression-logistique/unnamed-chunk-50-1.png" width="1050" />
<figcaption>
Odds ratio d’un modèle multinomial
</figcaption>
</figure>
</div>
<div id="regression-logistique-ordinale" class="section level2">
<h2>Régression logistique ordinale</h2>
<p>La <dfn>régression logistique ordinale</dfn><dfn data-index="ordinale, régression logistique"></dfn> s’applique lorsque la variable à expliquer possède trois ou plus modalités qui sont ordonnées (par exemple : modéré, moyen, fort).</p>
<p>L’extension la plus utilisée pour réaliser des modèles ordinaux est <code class="pkg">ordinal</code> et sa fonction <code data-pkg="ordinal">clm</code>. Il est même possible de réaliser des modèles ordinaux avec des <a href="modeles-a-effets-aleatoires.html">effets aléatoires</a> (modèles mixtes) à l’aide de la fonction <code data-pkg="ordinal">clmm</code>.</p>
<p>Pour une bonne introduction à l’extension <code class="pkg">ordinal</code>, on pourra se référer au tutoriel officiel (en anglais) : <a href="https://cran.r-project.org/web/packages/ordinal/vignettes/clm_tutorial.pdf" class="uri">https://cran.r-project.org/web/packages/ordinal/vignettes/clm_tutorial.pdf</a>.</p>
<p>Une autre introduction pertinente (en français) et utilisant cette fois-ci l’extention <code class="pkg">VGAM</code> et sa fonction <code data-pkg="VGAM">vglm</code> est disponible sur le site de l’université de Lyon : <a href="https://eric.univ-lyon2.fr/~ricco/cours/didacticiels/data-mining/didacticiel_Reg_Logistique_Polytomique_Ordinale.pdf" class="uri">https://eric.univ-lyon2.fr/~ricco/cours/didacticiels/data-mining/didacticiel_Reg_Logistique_Polytomique_Ordinale.pdf</a>.</p>
<p>On va reprendre l’exemple précédent puisque la variable <var>trav.satisf</var> est une variable ordonnée.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1"><span class="kw">freq</span>(d<span class="op">$</span>trav.satisf)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["n"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["%"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["val%"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"451","2":"22.6","3":"43.0","_rn_":"Equilibre"},{"1":"480","2":"24.0","3":"45.8","_rn_":"Satisfaction"},{"1":"117","2":"5.9","3":"11.2","_rn_":"Insatisfaction"},{"1":"952","2":"47.6","3":"NA","_rn_":"__NA__"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p><strong>ATTENTION :</strong> Dans le cas d’une régression logistique ordinale, il importante que les niveaux du facteur soient classés selon leur ordre hiéarchique (du plus faible au plus fort). On va dès lors recoder notre variable à expliquer.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1">d<span class="op">$</span>trav.satisf &lt;-<span class="st"> </span><span class="kw">factor</span>(d<span class="op">$</span>trav.satisf, <span class="kw">c</span>(<span class="st">&quot;Insatisfaction&quot;</span>, <span class="st">&quot;Equilibre&quot;</span>, </a>
<a class="sourceLine" id="cb89-2" title="2">  <span class="st">&quot;Satisfaction&quot;</span>), <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb89-3" title="3"><span class="kw">freq</span>(d<span class="op">$</span>trav.satisf)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["n"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["%"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["val%"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"117","2":"5.9","3":"11.2","_rn_":"Insatisfaction"},{"1":"451","2":"22.6","3":"43.0","_rn_":"Equilibre"},{"1":"480","2":"24.0","3":"45.8","_rn_":"Satisfaction"},{"1":"952","2":"47.6","3":"NA","_rn_":"__NA__"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="kw">library</span>(ordinal)</a>
<a class="sourceLine" id="cb90-2" title="2">rego &lt;-<span class="st"> </span><span class="kw">clm</span>(trav.satisf <span class="op">~</span><span class="st"> </span>sexe <span class="op">+</span><span class="st"> </span>etud <span class="op">+</span><span class="st"> </span>trav.imp, <span class="dt">data =</span> d)</a>
<a class="sourceLine" id="cb90-3" title="3"><span class="kw">summary</span>(rego)</a></code></pre></div>
<pre><code>formula: trav.satisf ~ sexe + etud + trav.imp
data:    d

 link  threshold nobs logLik  AIC     niter max.grad
 logit flexible  1048 -978.61 1977.23 5(0)  5.41e-09
 cond.H 
 3.9e+02

Coefficients:
                            Estimate Std. Error z value
sexeHomme                   -0.16141    0.12215  -1.321
etudSecondaire               0.05558    0.23220   0.239
etudTechnique/Professionnel  0.03373    0.21210   0.159
etudSupérieur                0.61336    0.21972   2.792
etudmanquant                -0.45555    0.48761  -0.934
trav.impAussi                0.35104    0.38578   0.910
trav.impMoins                0.02616    0.37174   0.070
trav.impPeu                 -1.66062    0.46204  -3.594
                            Pr(&gt;|z|)    
sexeHomme                   0.186369    
etudSecondaire              0.810819    
etudTechnique/Professionnel 0.873660    
etudSupérieur               0.005245 ** 
etudmanquant                0.350174    
trav.impAussi               0.362857    
trav.impMoins               0.943896    
trav.impPeu                 0.000325 ***
---
Signif. codes:  
0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Threshold coefficients:
                         Estimate Std. Error z value
Insatisfaction|Equilibre  -2.0226     0.4189  -4.829
Equilibre|Satisfaction     0.3391     0.4113   0.825
(952 observations deleted due to missingness)</code></pre>
<p>Une fois encore, il est possible de faire une sélection descendane pas à pas.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1">rego2 &lt;-<span class="st"> </span><span class="kw">step</span>(rego)</a></code></pre></div>
<pre><code>Start:  AIC=1977.23
trav.satisf ~ sexe + etud + trav.imp

           Df    AIC
- sexe      1 1977.0
&lt;none&gt;        1977.2
- etud      4 1990.6
- trav.imp  3 2013.2

Step:  AIC=1976.97
trav.satisf ~ etud + trav.imp

           Df    AIC
&lt;none&gt;        1977.0
- etud      4 1990.6
- trav.imp  3 2011.6</code></pre>
<p>L’extension <code class="pkg">broom</code> ne propose pas de méthode <code data-pkg="broom">tidy</code> pour les objets <code data-pks="ordinal">clm</code>. Cependant, on pourra en trouver une dans l’extension <code class="pkg">JLutils</code>. Pour rappel, cette extension est disponible uniquement sur <a href="https://github.com/larmarange/JLutils">GitHub</a> et s’installe donc ainsi :</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1"><span class="kw">install_github</span>(<span class="st">&quot;larmarange/JLutils&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="kw">library</span>(JLutils)</a>
<a class="sourceLine" id="cb95-2" title="2"><span class="kw">tidy</span>(rego2, <span class="dt">exponentiate =</span> <span class="ot">TRUE</span>, <span class="dt">conf.int =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["conf.low"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["conf.high"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["coefficient_type"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"Equilibre|Satisfaction","2":"1.5112340","3":"0.4070527","4":"1.01443002","5":"3.103776e-01","6":"NA","7":"NA","8":"alpha"},{"1":"etudmanquant","2":"0.6595865","3":"0.4870037","4":"-0.85449501","5":"3.928308e-01","6":"0.25296915","7":"1.7205700","8":"beta"},{"1":"etudSecondaire","2":"1.0625486","3":"0.2320661","4":"0.26143590","5":"7.937564e-01","6":"0.67374921","7":"1.6747176","8":"beta"},{"1":"etudSupérieur","2":"1.8404208","3":"0.2196152","4":"2.77755928","5":"5.476885e-03","6":"1.19619139","7":"2.8319521","8":"beta"},{"1":"etudTechnique/Professionnel","2":"1.0140018","3":"0.2114991","4":"0.06574345","5":"9.475821e-01","6":"0.66917118","7":"1.5346895","8":"beta"},{"1":"Insatisfaction|Equilibre","2":"0.1427923","3":"0.4142977","4":"-4.69798475","5":"2.627410e-06","6":"NA","7":"NA","8":"alpha"},{"1":"trav.impAussi","2":"1.3939432","3":"0.3849992","4":"0.86269411","5":"3.883057e-01","6":"0.65080539","7":"2.9656810","8":"beta"},{"1":"trav.impMoins","2":"1.0337601","3":"0.3712009","4":"0.08944679","5":"9.287268e-01","6":"0.49540445","7":"2.1402278","8":"beta"},{"1":"trav.impPeu","2":"0.1948513","3":"0.4610260","4":"-3.54756230","5":"3.888138e-04","6":"0.07837432","7":"0.4798506","8":"beta"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>La méthode <code data-pkg="JLutils" data-rdoc="tidy_model">tidy.clm</code> étant disponible, on peut utiliser <code data-pkg="GGally">ggcoef</code>.</p>
<figure>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1"><span class="kw">library</span>(JLutils)</a>
<a class="sourceLine" id="cb96-2" title="2"><span class="kw">library</span>(GGally)</a>
<a class="sourceLine" id="cb96-3" title="3"><span class="kw">ggcoef</span>(rego2, <span class="dt">exponentiate =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>Warning: Removed 2 rows containing missing values
(geom_errorbarh).</code></pre>
<img src="graphs/regression-logistique/unnamed-chunk-57-1.png" width="1050" />
<figcaption>
Coefficients du modèle ordinal
</figcaption>
</figure>
</div>
<div id="survey" class="section level2">
<h2>Données pondérées et l’extension survey</h2>
<p>Lorsque l’on utilise des données pondérées, on aura recours à l’extension <code class="pkg">survey</code><a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a>.</p>
<p>Préparons des données d’exemple :</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1"><span class="kw">library</span>(survey)</a>
<a class="sourceLine" id="cb98-2" title="2">dw &lt;-<span class="st"> </span><span class="kw">svydesign</span>(<span class="dt">ids =</span> <span class="op">~</span><span class="dv">1</span>, <span class="dt">data =</span> d, <span class="dt">weights =</span> <span class="op">~</span>poids)</a></code></pre></div>
<div id="regression-logistique-binaire-1" class="section level3">
<h3>Régression logistique binaire</h3>
<p>L’extension <code class="pkg">survey</code> fournit une fonction <code data-pkg="survey">svyglm</code> permettant de calculer un modèle statistique tout en prenant en compte le plan d’échantillonnage spécifié. La syntaxe de <code data-pkg="survey">svyglm</code> est proche de celle de <code data-pkg="stats">glm</code>. Cependant, le cadre d’une régression logistique, il est nécessaire d’utiliser <code>family = quasibinomial()</code> afin d’éviter un message d’erreur indiquant un nombre non entier de succès :</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1">reg &lt;-<span class="st"> </span><span class="kw">svyglm</span>(sport <span class="op">~</span><span class="st"> </span>sexe <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>relig <span class="op">+</span><span class="st"> </span>heures.tv, dw, <span class="dt">family =</span> <span class="kw">binomial</span>())</a></code></pre></div>
<pre><code>Warning in eval(family$initialize): non-integer #successes
in a binomial glm!</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1">reg &lt;-<span class="st"> </span><span class="kw">svyglm</span>(sport <span class="op">~</span><span class="st"> </span>sexe <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>relig <span class="op">+</span><span class="st"> </span>heures.tv, dw, <span class="dt">family =</span> <span class="kw">quasibinomial</span>())</a>
<a class="sourceLine" id="cb101-2" title="2">reg</a></code></pre></div>
<pre><code>Independent Sampling design (with replacement)
svydesign(ids = ~1, data = d, weights = ~poids)

Call:  svyglm(formula = sport ~ sexe + age + relig + heures.tv, design = dw, 
    family = quasibinomial())

Coefficients:
                     (Intercept)  
                         1.53590  
                       sexeHomme  
                         0.36526  
                             age  
                        -0.04127  
     religPratiquant occasionnel  
                         0.05577  
 religAppartenance sans pratique  
                         0.16367  
religNi croyance ni appartenance  
                         0.03988  
                      religRejet  
                        -0.14862  
                religNSP ou NVPR  
                        -0.22682  
                       heures.tv  
                        -0.18204  

Degrees of Freedom: 1994 Total (i.e. Null);  1986 Residual
  (5 observations deleted due to missingness)
Null Deviance:      2672 
Residual Deviance: 2378     AIC: NA</code></pre>
<p>Le résultat obtenu est similaire à celui de <code data-pkg="stats">glm</code> et l’on peut utiliser sans problème les fonctions <code data-pkg="survey" data-rdoc="svyglm">coef</code>, <code data-pkg="survey" data-rdoc="confint.glm">confint</code>, <code data-pkg="questionr">odds.ratio</code>, <code data-pkg="survey" data-rdoc="svyglm">predict</code> ou encore <code data-pkg="broom" data-rdoc="glm_tidiers">tidy</code>.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1"><span class="kw">odds.ratio</span>(reg)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["OR"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["2.5 %"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["97.5 %"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["p"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"4.6455262","2":"2.5775794","3":"8.3725505","4":"3.522452e-07","_rn_":"(Intercept)"},{"1":"1.4408950","2":"1.1214960","3":"1.8512578","4":"4.324505e-03","_rn_":"sexeHomme"},{"1":"0.9595746","2":"0.9518052","3":"0.9674074","4":"8.648927e-23","_rn_":"age"},{"1":"1.0573550","2":"0.6590167","3":"1.6964662","4":"8.171797e-01","_rn_":"religPratiquant occasionnel"},{"1":"1.1778210","2":"0.7591124","3":"1.8274795","4":"4.653212e-01","_rn_":"religAppartenance sans pratique"},{"1":"1.0406833","2":"0.6463807","3":"1.6755167","4":"8.696579e-01","_rn_":"religNi croyance ni appartenance"},{"1":"0.8618968","2":"0.4275166","3":"1.7376311","4":"6.778577e-01","_rn_":"religRejet"},{"1":"0.7970656","2":"0.3248073","3":"1.9559707","4":"6.205041e-01","_rn_":"religNSP ou NVPR"},{"1":"0.8335645","2":"0.7701918","3":"0.9021516","4":"6.785556e-06","_rn_":"heures.tv"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" title="1"><span class="kw">library</span>(broom)</a>
<a class="sourceLine" id="cb104-2" title="2"><span class="kw">tidy</span>(reg, <span class="dt">exponentiate =</span> <span class="ot">TRUE</span>, <span class="dt">conf.int =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["conf.low"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["conf.high"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"4.6455262","3":"0.300543226","4":"5.1104285","5":"3.522452e-07","6":"2.5775794","7":"8.3725505"},{"1":"sexeHomme","2":"1.4408950","3":"0.127859939","4":"2.8567542","5":"4.324505e-03","6":"1.1214960","7":"1.8512578"},{"1":"age","2":"0.9595746","3":"0.004147866","4":"-9.9485426","5":"8.648927e-23","6":"0.9518052","7":"0.9674074"},{"1":"religPratiquant occasionnel","2":"1.0573550","3":"0.241217139","4":"0.2312045","5":"8.171797e-01","6":"0.6590167","7":"1.6964662"},{"1":"religAppartenance sans pratique","2":"1.1778210","3":"0.224122249","4":"0.7302539","5":"4.653212e-01","6":"0.7591124","7":"1.8274795"},{"1":"religNi croyance ni appartenance","2":"1.0406833","3":"0.242986159","4":"0.1641142","5":"8.696579e-01","6":"0.6463807","7":"1.6755167"},{"1":"religRejet","2":"0.8618968","3":"0.357732331","4":"-0.4154496","5":"6.778577e-01","6":"0.4275166","7":"1.7376311"},{"1":"religNSP ou NVPR","2":"0.7970656","3":"0.458021132","4":"-0.4952137","5":"6.205041e-01","6":"0.3248073","7":"1.9559707"},{"1":"heures.tv","2":"0.8335645","3":"0.040343332","4":"-4.5123745","5":"6.785556e-06","6":"0.7701918","7":"0.9021516"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Dans ses dernières versions, <code class="pkg">survey</code> fournit une méthode <code data-pkg="survey" data-rdoc="anova.svyglm">AIC.svyglm</code> permettant d’estimer un <dfn>AIC</dfn> sur un modèle calculé avec <code data-pkg="survey">svyglm</code>. Il est dès lors possible d’utiliser la fonction <code data-pkg="stats">step</code> pour réaliser une <dfn>sélection descendante pas à pas</dfn><dfn data-index="pas à pas, sélection descendante"></dfn>.</p>
<p>L’extension <code class="pkg">effects</code> n’est quant à elle pas compatible avec <code data-pkg="survey">svyglm</code><a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a>.</p>
</div>
<div id="regression-multinomiale" class="section level3">
<h3>Régression multinomiale</h3>
<p>L’extension <code class="pkg">survey</code> ne fournit pas de fonction adaptée aux régressions multinomiales. Cependant, il est possible d’en réaliser une en ayant recours à des <dfn>poids de réplication</dfn><dfn data-index="réplication, poids"></dfn>, comme suggéré par Thomas Lumley dans son ouvrage <em>Complex Surveys: A Guide to Analysis Using R</em>. Thomas Lumley est par ailleurs l’auteur de l’extension <code class="pkg">survey</code>.</p>
<p>L’extension <code class="pkg">svrepmisc</code> disponible sur <a href="https://github.com/carlganz/svrepmisc">GitHub</a> fournit quelques fonctions facilitant l’utilisation des poids de réplication avec <code class="pkg">survey</code>. Pour l’installer, on utilisera le code ci-dessous :</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;carlganz/svrepmisc&quot;</span>)</a></code></pre></div>
<p>En premier lieu, il faut définir le design de notre tableau de données puis calculer des poids de réplication.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" title="1"><span class="kw">library</span>(survey)</a>
<a class="sourceLine" id="cb106-2" title="2">dw &lt;-<span class="st"> </span><span class="kw">svydesign</span>(<span class="dt">ids =</span> <span class="op">~</span><span class="dv">1</span>, <span class="dt">data =</span> d, <span class="dt">weights =</span> <span class="op">~</span>poids)</a>
<a class="sourceLine" id="cb106-3" title="3">dwr &lt;-<span class="st"> </span><span class="kw">as.svrepdesign</span>(dw, <span class="dt">type =</span> <span class="st">&quot;bootstrap&quot;</span>, <span class="dt">replicates =</span> <span class="dv">100</span>)</a></code></pre></div>
<p>Il faut prévoir un nombre de <code>replicates</code> suffisant pour calculer ultérieurement les intervalles de confiance des coefficients. Plus ce nombre est élevé, plus précise sera l’estimation de la variance et donc des valeurs p et des intervalles de confiance. Cependant, plus ce nombre est élevé, plus le temps de calcul sera important.</p>
<p><code class="pkg">svrepmisc</code> fournit une fonction <code data-pkg="svrepmisc">svymultinom</code> pour le calcul d’une régression multinomiale avec des poids de réplication.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1"><span class="kw">library</span>(svrepmisc)</a>
<a class="sourceLine" id="cb107-2" title="2">regm &lt;-<span class="st"> </span><span class="kw">svymultinom</span>(trav.satisf <span class="op">~</span><span class="st"> </span>sexe <span class="op">+</span><span class="st"> </span>etud <span class="op">+</span><span class="st"> </span>grpage <span class="op">+</span><span class="st"> </span>trav.imp, </a>
<a class="sourceLine" id="cb107-3" title="3">  <span class="dt">design =</span> dwr)</a></code></pre></div>
<p><code class="pkg">svrepmisc</code> fournit également des méthodes <code data-pkg="svrepmisc" data-rdoc="svymultinom">confint</code> et <code data-pkg="svrepmisc" data-rdoc="tidy.svrepstatmisc">tidy</code>. Il est également possible d’utiliser <code data-pkg="GGally">ggcoef</code>.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" title="1">regm</a></code></pre></div>
<pre><code>                                         Coefficient
Equilibre.(Intercept)                        0.93947
Satisfaction.(Intercept)                     0.74127
Equilibre.sexeHomme                         -0.24304
Satisfaction.sexeHomme                      -0.27381
Equilibre.etudSecondaire                    -0.41802
Satisfaction.etudSecondaire                 -0.26579
Equilibre.etudTechnique/Professionnel       -0.47708
Satisfaction.etudTechnique/Professionnel    -0.23585
Equilibre.etudSupérieur                     -0.57579
Satisfaction.etudSupérieur                   0.36801
Equilibre.etudmanquant                      -0.32346
Satisfaction.etudmanquant                   -0.65343
Equilibre.grpage[25,45)                      0.60710
Satisfaction.grpage[25,45)                   0.46941
Equilibre.grpage[45,65)                      0.57989
Satisfaction.grpage[45,65)                   0.52873
Equilibre.grpage[65,99]                     -3.20673
Satisfaction.grpage[65,99]                  11.60092
Equilibre.trav.impAussi                      0.42551
Satisfaction.trav.impAussi                   0.54156
Equilibre.trav.impMoins                      0.73727
Satisfaction.trav.impMoins                   0.66621
Equilibre.trav.impPeu                       -1.54722
Satisfaction.trav.impPeu                    -1.47191
                                               SE t value
Equilibre.(Intercept)                     2.53558  0.3705
Satisfaction.(Intercept)                  2.51155  0.2951
Equilibre.sexeHomme                       0.28467 -0.8538
Satisfaction.sexeHomme                    0.28365 -0.9653
Equilibre.etudSecondaire                  0.59127 -0.7070
Satisfaction.etudSecondaire               0.60683 -0.4380
Equilibre.etudTechnique/Professionnel     0.48163 -0.9906
Satisfaction.etudTechnique/Professionnel  0.52387 -0.4502
Equilibre.etudSupérieur                   0.51182 -1.1250
Satisfaction.etudSupérieur                0.52699  0.6983
Equilibre.etudmanquant                    5.19623 -0.0622
Satisfaction.etudmanquant                 5.06879 -0.1289
Equilibre.grpage[25,45)                   0.55680  1.0903
Satisfaction.grpage[25,45)                0.60663  0.7738
Equilibre.grpage[45,65)                   0.53465  1.0846
Satisfaction.grpage[45,65)                0.56968  0.9281
Equilibre.grpage[65,99]                  16.34714 -0.1962
Satisfaction.grpage[65,99]               19.04557  0.6091
Equilibre.trav.impAussi                   2.62975  0.1618
Satisfaction.trav.impAussi                2.65095  0.2043
Equilibre.trav.impMoins                   2.58519  0.2852
Satisfaction.trav.impMoins                2.59846  0.2564
Equilibre.trav.impPeu                     2.63023 -0.5882
Satisfaction.trav.impPeu                  2.67461 -0.5503
                                         Pr(&gt;|t|)
Equilibre.(Intercept)                      0.7120
Satisfaction.(Intercept)                   0.7687
Equilibre.sexeHomme                        0.3959
Satisfaction.sexeHomme                     0.3375
Equilibre.etudSecondaire                   0.4817
Satisfaction.etudSecondaire                0.6626
Equilibre.etudTechnique/Professionnel      0.3250
Satisfaction.etudTechnique/Professionnel   0.6538
Equilibre.etudSupérieur                    0.2641
Satisfaction.etudSupérieur                 0.4871
Equilibre.etudmanquant                     0.9505
Satisfaction.etudmanquant                  0.8978
Equilibre.grpage[25,45)                    0.2790
Satisfaction.grpage[25,45)                 0.4415
Equilibre.grpage[45,65)                    0.2815
Satisfaction.grpage[45,65)                 0.3563
Equilibre.grpage[65,99]                    0.8450
Satisfaction.grpage[65,99]                 0.5443
Equilibre.trav.impAussi                    0.8719
Satisfaction.trav.impAussi                 0.8387
Equilibre.trav.impMoins                    0.7763
Satisfaction.trav.impMoins                 0.7983
Equilibre.trav.impPeu                      0.5581
Satisfaction.trav.impPeu                   0.5837</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" title="1"><span class="kw">confint</span>(regm)</a></code></pre></div>
<pre><code>                                               2.5 %
Equilibre.(Intercept)                     -4.1105799
Satisfaction.(Intercept)                  -4.2609185
Equilibre.sexeHomme                       -0.8100132
Satisfaction.sexeHomme                    -0.8387371
Equilibre.etudSecondaire                  -1.5956382
Satisfaction.etudSecondaire               -1.4744016
Equilibre.etudTechnique/Professionnel     -1.4363288
Satisfaction.etudTechnique/Professionnel  -1.2792223
Equilibre.etudSupérieur                   -1.5951624
Satisfaction.etudSupérieur                -0.6815762
Equilibre.etudmanquant                   -10.6726405
Satisfaction.etudmanquant                -10.7487977
Equilibre.grpage[25,45)                   -0.5018690
Satisfaction.grpage[25,45)                -0.7387936
Equilibre.grpage[45,65)                   -0.4849578
Satisfaction.grpage[45,65)                -0.6058857
Equilibre.grpage[65,99]                  -35.7648945
Satisfaction.grpage[65,99]               -26.3316162
Equilibre.trav.impAussi                   -4.8120840
Satisfaction.trav.impAussi                -4.7382613
Equilibre.trav.impMoins                   -4.4115910
Satisfaction.trav.impMoins                -4.5090669
Equilibre.trav.impPeu                     -6.7857688
Satisfaction.trav.impPeu                  -6.7988591
                                             97.5 %
Equilibre.(Intercept)                     5.9895174
Satisfaction.(Intercept)                  5.7434576
Equilibre.sexeHomme                       0.3239302
Satisfaction.sexeHomme                    0.2911244
Equilibre.etudSecondaire                  0.7595935
Satisfaction.etudSecondaire               0.9428122
Equilibre.etudTechnique/Professionnel     0.4821678
Satisfaction.etudTechnique/Professionnel  0.8075153
Equilibre.etudSupérieur                   0.4435855
Satisfaction.etudSupérieur                1.4176002
Equilibre.etudmanquant                   10.0257212
Satisfaction.etudmanquant                 9.4419339
Equilibre.grpage[25,45)                   1.7160709
Satisfaction.grpage[25,45)                1.6776051
Equilibre.grpage[45,65)                   1.6447355
Satisfaction.grpage[45,65)                1.6633447
Equilibre.grpage[65,99]                  29.3514248
Satisfaction.grpage[65,99]               49.5334550
Equilibre.trav.impAussi                   5.6631048
Satisfaction.trav.impAussi                5.8213862
Equilibre.trav.impMoins                   5.8861226
Satisfaction.trav.impMoins                5.8414772
Equilibre.trav.impPeu                     3.6913326
Satisfaction.trav.impPeu                  3.8550334</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" title="1"><span class="kw">library</span>(broom)</a>
<a class="sourceLine" id="cb112-2" title="2"><span class="kw">tidy</span>(regm, <span class="dt">exponentiate =</span> <span class="ot">TRUE</span>, <span class="dt">conf.int =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["conf.low"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["conf.high"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"Equilibre.(Intercept)","2":"2.558622e+00","3":"2.5355817","4":"0.37051409","5":"0.7120302","6":"1.639826e-02","7":"3.992219e+02"},{"1":"Equilibre.etudmanquant","2":"7.236412e-01","3":"5.1962259","4":"-0.06224895","5":"0.9505280","6":"2.317027e-05","7":"2.260036e+04"},{"1":"Equilibre.etudSecondaire","2":"6.583475e-01","3":"0.5912698","4":"-0.70699091","5":"0.4817343","6":"2.027791e-01","7":"2.137407e+00"},{"1":"Equilibre.etudSupérieur","2":"5.622614e-01","3":"0.5118180","4":"-1.12498658","5":"0.2641351","6":"2.028756e-01","7":"1.558285e+00"},{"1":"Equilibre.etudTechnique/Professionnel","2":"6.205926e-01","3":"0.4816295","4":"-0.99055489","5":"0.3250463","6":"2.377992e-01","7":"1.619582e+00"},{"1":"Equilibre.grpage[25,45)","2":"1.835104e+00","3":"0.5568033","4":"1.09033278","5":"0.2790115","6":"6.053981e-01","7":"5.562629e+00"},{"1":"Equilibre.grpage[45,65)","2":"1.785840e+00","3":"0.5346494","4":"1.08461504","5":"0.2815209","6":"6.157232e-01","7":"5.179640e+00"},{"1":"Equilibre.grpage[65,99]","2":"4.048860e-02","3":"16.3471443","4":"-0.19616483","5":"0.8450047","6":"2.934294e-16","7":"5.586783e+12"},{"1":"Equilibre.sexeHomme","2":"7.842390e-01","3":"0.2846711","4":"-0.85376228","5":"0.3959197","6":"4.448522e-01","7":"1.382551e+00"},{"1":"Equilibre.trav.impAussi","2":"1.530371e+00","3":"2.6297466","4":"0.16180661","5":"0.8718875","6":"8.130897e-03","7":"2.880416e+02"},{"1":"Equilibre.trav.impMoins","2":"2.090213e+00","3":"2.5851924","4":"0.28518797","5":"0.7762759","6":"1.213585e-02","7":"3.600067e+02"},{"1":"Equilibre.trav.impPeu","2":"2.128392e-01","3":"2.6302268","4":"-0.58824513","5":"0.5581119","6":"1.129739e-03","7":"4.009825e+01"},{"1":"Satisfaction.(Intercept)","2":"2.098598e+00","3":"2.5115514","4":"0.29514409","5":"0.7686886","6":"1.410934e-02","7":"3.121418e+02"},{"1":"Satisfaction.etudmanquant","2":"5.202573e-01","3":"5.0687878","4":"-0.12891285","5":"0.8977672","6":"2.147121e-05","7":"1.260607e+04"},{"1":"Satisfaction.etudSecondaire","2":"7.665965e-01","3":"0.6068301","4":"-0.43800515","5":"0.6626249","6":"2.289157e-01","7":"2.567191e+00"},{"1":"Satisfaction.etudSupérieur","2":"1.444859e+00","3":"0.5269883","4":"0.69833042","5":"0.4871019","6":"5.058191e-01","7":"4.127204e+00"},{"1":"Satisfaction.etudTechnique/Professionnel","2":"7.898964e-01","3":"0.5238656","4":"-0.45021756","5":"0.6538352","6":"2.782536e-01","7":"2.242330e+00"},{"1":"Satisfaction.grpage[25,45)","2":"1.599044e+00","3":"0.6066255","4":"0.77379832","5":"0.4414504","6":"4.776899e-01","7":"5.352721e+00"},{"1":"Satisfaction.grpage[45,65)","2":"1.696775e+00","3":"0.5696796","4":"0.92811737","5":"0.3562850","6":"5.455910e-01","7":"5.276931e+00"},{"1":"Satisfaction.grpage[65,99]","2":"1.091981e+05","3":"19.0455677","4":"0.60911387","5":"0.5442655","6":"3.667114e-12","7":"3.251668e+21"},{"1":"Satisfaction.sexeHomme","2":"7.604793e-01","3":"0.2836464","4":"-0.96530870","5":"0.3374519","6":"4.322561e-01","7":"1.337931e+00"},{"1":"Satisfaction.trav.impAussi","2":"1.718690e+00","3":"2.6509496","4":"0.20428999","5":"0.8386730","6":"8.753853e-03","7":"3.374395e+02"},{"1":"Satisfaction.trav.impMoins","2":"1.946835e+00","3":"2.5984552","4":"0.25638507","5":"0.7983463","6":"1.100873e-02","7":"3.442875e+02"},{"1":"Satisfaction.trav.impPeu","2":"2.294861e-01","3":"2.6746094","4":"-0.55032816","5":"0.5837082","6":"1.115047e-03","7":"4.723020e+01"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="regression-ordinale" class="section level3">
<h3>Régression ordinale</h3>
<p>Pour un modèle ordinal, il existe une version simplifiée des modèles ordinaux directement disponible dans <code class="pkg">survey</code> via la fonction <code data-pkg="survey">svyolr</code>.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1">rego &lt;-<span class="st"> </span><span class="kw">svyolr</span>(trav.satisf <span class="op">~</span><span class="st"> </span>sexe <span class="op">+</span><span class="st"> </span>etud <span class="op">+</span><span class="st"> </span>trav.imp, <span class="dt">design =</span> dw)</a>
<a class="sourceLine" id="cb113-2" title="2"><span class="kw">summary</span>(rego)</a></code></pre></div>
<pre><code>Call:
svyolr(trav.satisf ~ sexe + etud + trav.imp, design = dw)

Coefficients:
                                    Value Std. Error
sexeHomme                   -0.1328026100  0.1545640
etudSecondaire              -0.0427151234  0.2751085
etudTechnique/Professionnel  0.0004261287  0.2492533
etudSupérieur                0.6424698737  0.2593446
etudmanquant                -0.4694599623  0.5033490
trav.impAussi                0.1207125976  0.5044264
trav.impMoins                0.0526740003  0.4895782
trav.impPeu                 -1.5303889517  0.7215699
                                 t value
sexeHomme                   -0.859207986
etudSecondaire              -0.155266460
etudTechnique/Professionnel  0.001709621
etudSupérieur                2.477282672
etudmanquant                -0.932672851
trav.impAussi                0.239306656
trav.impMoins                0.107590577
trav.impPeu                 -2.120915790

Intercepts:
                         Value   Std. Error t value
Insatisfaction|Equilibre -2.0392  0.5427    -3.7577
Equilibre|Satisfaction    0.2727  0.5306     0.5140
(952 observations deleted due to missingness)</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" title="1"><span class="kw">confint</span>(rego)</a></code></pre></div>
<pre><code>                                 2.5 %     97.5 %
sexeHomme                   -0.4357425  0.1701372
etudSecondaire              -0.5819179  0.4964876
etudTechnique/Professionnel -0.4881013  0.4889536
etudSupérieur                0.1341638  1.1507759
etudmanquant                -1.4560059  0.5170860
trav.impAussi               -0.8679450  1.1093702
trav.impMoins               -0.9068816  1.0122296
trav.impPeu                 -2.9446399 -0.1161380
Insatisfaction|Equilibre    -3.1027595 -0.9755811
Equilibre|Satisfaction       0.1607965  0.3846345</code></pre>
<p>L’extension <code class="pkg">JLutils</code><a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a> propose une méthode <code data-pkg="JLutils" data-rdoc="tidy_model">tidy</code> pour les objets <code>svyolr.</code></p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1"><span class="kw">library</span>(JLutils)</a>
<a class="sourceLine" id="cb117-2" title="2"><span class="kw">library</span>(broom)</a>
<a class="sourceLine" id="cb117-3" title="3"><span class="kw">tidy</span>(rego, <span class="dt">exponentiate =</span> <span class="ot">TRUE</span>, <span class="dt">conf.int =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["conf.low"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["conf.high"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["coefficient_type"],"name":[7],"type":["chr"],"align":["left"]}],"data":[{"1":"Equilibre|Satisfaction","2":"1.3135265","3":"0.5305802","4":"0.513994918","5":"1.17444595","6":"1.4690773","7":"zeta"},{"1":"etudmanquant","2":"0.6253399","3":"0.5033490","4":"-0.932672851","5":"0.23316570","6":"1.6771333","7":"coefficient"},{"1":"etudSecondaire","2":"0.9581843","3":"0.2751085","4":"-0.155266460","5":"0.55882558","6":"1.6429405","7":"coefficient"},{"1":"etudSupérieur","2":"1.9011707","3":"0.2593446","4":"2.477282672","5":"1.14358013","6":"3.1606444","7":"coefficient"},{"1":"etudTechnique/Professionnel","2":"1.0004262","3":"0.2492533","4":"0.001709621","5":"0.61379069","6":"1.6306090","7":"coefficient"},{"1":"Insatisfaction|Equilibre","2":"0.1301366","3":"0.5426575","4":"-3.757748101","5":"0.04492506","6":"0.3769732","7":"zeta"},{"1":"sexeHomme","2":"0.8756379","3":"0.1545640","4":"-0.859207986","5":"0.64678428","6":"1.1854675","7":"coefficient"},{"1":"trav.impAussi","2":"1.1283006","3":"0.5044264","4":"0.239306656","5":"0.41981338","6":"3.0324479","7":"coefficient"},{"1":"trav.impMoins","2":"1.0540860","3":"0.4895782","4":"0.107590577","5":"0.40378140","6":"2.7517295","7":"coefficient"},{"1":"trav.impPeu","2":"0.2164515","3":"0.7215699","4":"-2.120915790","5":"0.05262100","6":"0.8903524","7":"coefficient"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Une alternative est d’avoir recours, comme pour la régression multinomiale, aux poids de réplication et à la fonction <code data-pkg="svrepmisc">svyclm</code> implémentée dans l’extension <code class="pkg">svrepmisc</code>.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" title="1">dwr &lt;-<span class="st"> </span><span class="kw">as.svrepdesign</span>(dw, <span class="dt">type =</span> <span class="st">&quot;bootstrap&quot;</span>, <span class="dt">replicates =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb118-2" title="2"><span class="kw">library</span>(svrepmisc)</a>
<a class="sourceLine" id="cb118-3" title="3">rego_alt &lt;-<span class="st"> </span><span class="kw">svyclm</span>(trav.satisf <span class="op">~</span><span class="st"> </span>sexe <span class="op">+</span><span class="st"> </span>etud <span class="op">+</span><span class="st"> </span>trav.imp, <span class="dt">design =</span> dwr)</a>
<a class="sourceLine" id="cb118-4" title="4">rego_alt</a></code></pre></div>
<pre><code>                            Coefficient          SE t value
Insatisfaction|Equilibre    -2.03917466  0.52310573 -3.8982
Equilibre|Satisfaction       0.27271800  0.51129939  0.5334
sexeHomme                   -0.13280477  0.17994511 -0.7380
etudSecondaire              -0.04271403  0.28644151 -0.1491
etudTechnique/Professionnel  0.00042809  0.23725221  0.0018
etudSupérieur                0.64247607  0.24078284  2.6683
etudmanquant                -0.46945975  0.47201837 -0.9946
trav.impAussi                0.12071087  0.49877470  0.2420
trav.impMoins                0.05267146  0.49376161  0.1067
trav.impPeu                 -1.53039056  0.77926413 -1.9639
                             Pr(&gt;|t|)    
Insatisfaction|Equilibre    0.0001863 ***
Equilibre|Satisfaction      0.5950838    
sexeHomme                   0.4624167    
etudSecondaire              0.8817929    
etudTechnique/Professionnel 0.9985643    
etudSupérieur               0.0090425 ** 
etudmanquant                0.3226074    
trav.impAussi               0.8093193    
trav.impMoins               0.9152851    
trav.impPeu                 0.0526287 .  
---
Signif. codes:  
0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" title="1"><span class="kw">confint</span>(rego_alt)</a></code></pre></div>
<pre><code>                                 2.5 %      97.5 %
Insatisfaction|Equilibre    -3.0784155 -0.99993382
Equilibre|Satisfaction      -0.7430675  1.28850348
sexeHomme                   -0.4902971  0.22468761
etudSecondaire              -0.6117801  0.52635202
etudTechnique/Professionnel -0.4709148  0.47177100
etudSupérieur                0.1641189  1.12083322
etudmanquant                -1.4072066  0.46828713
trav.impAussi               -0.8701921  1.11161387
trav.impMoins               -0.9282722  1.03361509
trav.impPeu                 -3.0785348  0.01775364</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" title="1"><span class="kw">tidy</span>(rego_alt, <span class="dt">exponentiate =</span> <span class="ot">TRUE</span>, <span class="dt">conf.int =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["conf.low"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["conf.high"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"Equilibre|Satisfaction","2":"1.3135298","3":"0.5112994","4":"0.533382223","5":"0.5950838039","6":"0.47565262","7":"3.6273541"},{"1":"etudmanquant","2":"0.6253400","3":"0.4720184","4":"-0.994579406","5":"0.3226074037","6":"0.24482622","7":"1.5972560"},{"1":"etudSecondaire","2":"0.9581854","3":"0.2864415","4":"-0.149119564","5":"0.8817929254","6":"0.54238452","7":"1.6927459"},{"1":"etudSupérieur","2":"1.9011825","3":"0.2407828","4":"2.668280084","5":"0.0090425236","6":"1.17835444","7":"3.0674090"},{"1":"etudTechnique/Professionnel","2":"1.0004282","3":"0.2372522","4":"0.001804347","5":"0.9985643339","6":"0.62443076","7":"1.6028303"},{"1":"Insatisfaction|Equilibre","2":"0.1301361","3":"0.5231057","4":"-3.898207470","5":"0.0001862807","6":"0.04603214","7":"0.3679038"},{"1":"sexeHomme","2":"0.8756360","3":"0.1799451","4":"-0.738029307","5":"0.4624167064","6":"0.61244438","7":"1.2519316"},{"1":"trav.impAussi","2":"1.1282986","3":"0.4987747","4":"0.242014813","5":"0.8093192934","6":"0.41887106","7":"3.0392594"},{"1":"trav.impMoins","2":"1.0540833","3":"0.4937616","4":"0.106673866","5":"0.9152851385","6":"0.39523602","7":"2.8112103"},{"1":"trav.impPeu","2":"0.2164511","3":"0.7792641","4":"-1.963891968","5":"0.0526287258","6":"0.04602665","7":"1.0179122"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Il existe également une fonction <code data-pkg="base">add.NA</code> fournie avec <strong>R</strong>. Mais elle ne permet pas de choisir l’étiquette du nouveau niveau créé. Plus spécfiquement, cette étiquette est <code>NA</code> et non une valeur textuelle, ce qui peut créer des problèmes avec certaines fonctions.<a href="#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>Pour plus de détails, voir <a href="http://www.spc.univ-lyon1.fr/polycop/odds%20ratio.htm" class="uri">http://www.spc.univ-lyon1.fr/polycop/odds%20ratio.htm</a>.<a href="#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p>Cette extension est livrée avec de nombreuses vignettes dont une <a href="https://cran.r-project.org/web/packages/ggeffects/vignettes/marginaleffects.html">vignette d’introduction</a> présentant le fonctionnement des différentes fonctions.<a href="#fnref3" class="footnote-back">↩</a></p></li>
<li id="fn4"><p>Il existe également des méthodes de <em>sélection ascendante pas à pas</em>, mais nous les aborderons pas ici.<a href="#fnref4" class="footnote-back">↩</a></p></li>
<li id="fn5"><p>Une alternative est d’avoir recours à l’extension <code class="pkg">mlogit</code> que nous n’aborderons pas ici. Voir <a href="http://www.ats.ucla.edu/stat/r/dae/mlogit.htm" class="uri">http://www.ats.ucla.edu/stat/r/dae/mlogit.htm</a> (en anglais) pour plus de détails.<a href="#fnref5" class="footnote-back">↩</a></p></li>
<li id="fn6"><p>Voir le chapitre dédié aux <a href="donnees-ponderees.html#survey">données pondérées</a>.<a href="#fnref6" class="footnote-back">↩</a></p></li>
<li id="fn7"><p>Compatibilité qui pourra éventuellement être introduite dans une future version de l’extension.<a href="#fnref7" class="footnote-back">↩</a></p></li>
<li id="fn8"><p><code>devtools::install_github("larmarange/JLutils")</code> pour l’installer<a href="#fnref8" class="footnote-back">↩</a></p></li>
</ol>
</div>

</article>
</div>

<div class="col-sm-3" role="complementary">
<nav class="hidden-print hidden-xs" id="nav_sidebar">
</nav>
</div>

</div>

<script>
// manage active state of menu based on current page
$(document).ready(function () {

    // active menu
    href = window.location.pathname;
    href = href.substr(href.lastIndexOf('/') + 1);
    if (href=='') href = 'index.html';
    $('a[href="' + href + '"]').parent().addClass('active');
    $('a[href="' + href + '"]').parent().parents('li').addClass('active');

    // élargir la page d'accueil
    if (href=='index.html') $('.col-sm-9').attr('class','col-sm-12');

    // rechercher
    $("#rechercher").submit(function(event) {
      $('input[name="q"]').val($('input[name="q"]').val() + ' site:larmarange.github.io/analyse-R');
    });

    // sidebar
    $("#nav_sidebar").append($("#TOC").html());
    $("#nav_sidebar ul").addClass("nav nav-stacked");
    $("#TOC").addClass("visible-xs-block");
    $('body').scrollspy({
      target: '#nav_sidebar',
      offset: 40
    });

    // Identifier les <pre> fermant
    $('pre').next("*:not(pre)").prev().addClass('last'); // Dernier <pre> de chaque groupe contigu de <pre>
    $('pre').parent().each(function (){
      $(this).children('pre').last().addClass('last');
    }); // Si <pre> est le dernier enfant de son parent

    // Ajout liens rdocumentation et tooltip
    $("code[data-pkg]").each(function( index ) {
      pkg = $(this).attr('data-pkg');
      if ($(this).attr('data-rdoc') !== undefined) {
        rdocumentation = $(this).attr('data-rdoc');
      } else {
        rdocumentation = $(this).text();
      }
      fonction = $(this).text();
      //$(this).wrap('<a href="http://www.rdocumentation.org/packages/'+pkg+'/functions/'+rdocumentation+'">');
      $(this).wrap('<a href="http://rdrr.io/pkg/'+pkg+'/sym/'+rdocumentation+'">');
      $(this).attr('data-toggle','tooltip');
      $(this).attr('data-placement','top');
      $(this).attr('title','package : ' + pkg);
      $('[data-toggle="tooltip"]').tooltip();
    });

    $("code.pkg").each(function( index ) {
      //$(this).wrap('<a href="http://www.rdocumentation.org/packages/'+$(this).text()+'">');
      $(this).wrap('<a href="http://rdrr.io/pkg/'+$(this).text()+'">');
    });

    // Figures
    $("figure").each(function( index ) {
      if ($(this).children("figcaption").length > 0)
        $(this).children("figcaption:first").prepend('<span class="figure-number">Figure '+(index+1)+'.</span> ');
      else
        $(this).append($("<figcaption>").append('<span class="figure-number">Figure '+(index+1)+'</span>'));
    });

    // Colorbox

    /*----
    jQuery('article div img').colorbox({
      maxWidth: '90%',
      maxHeight: '90%',
      rel: 'figures',
      current: "",
      href: function(){
        return $(this).attr('src');
      },
      title: function(){
        return $(this).attr('alt');
      }
    });
    jQuery('article div img').css('cursor', 'pointer');
    jQuery('figure img').colorbox({
      maxWidth: '90%',
      maxHeight: '90%',
      rel: 'figures',
      current: "",
      href: function(){
        return $(this).attr('src');
      },
      title: function(){
        return $(this).parent().children("figcaption").text();
      }
    });
    jQuery('figure img').css('cursor', 'pointer');

    -----*/

    /* Clipboard --------------------------*/

  function changeTooltipMessage(element, msg) {
    var tooltipOriginalTitle=element.getAttribute('data-original-title');
    element.setAttribute('data-original-title', msg);
    $(element).tooltip('show');
    element.setAttribute('data-original-title', tooltipOriginalTitle);
  }

  if(ClipboardJS.isSupported()) {
    $(document).ready(function() {
      var copyButton = "<button type='button' class='btn btn-primary btn-copy-ex' type = 'submit' title='Copier dans le presse-papier' aria-label='Copier dans le presse-papier' data-toggle='tooltip' data-placement='left auto' data-trigger='hover' data-clipboard-copy><i class='fa fa-copy'></i></button>";

      $(".examples, div.sourceCode").addClass("hasCopyButton");

      // Insert copy buttons:
      $(copyButton).prependTo(".hasCopyButton");

      // Initialize tooltips:
      $('.btn-copy-ex').tooltip({container: 'body'});

      // Initialize clipboard:
      var clipboardBtnCopies = new ClipboardJS('[data-clipboard-copy]', {
        text: function(trigger) {
          return trigger.parentNode.textContent;
        }
      });

      clipboardBtnCopies.on('success', function(e) {
        changeTooltipMessage(e.trigger, 'Copié !');
        e.clearSelection();
      });

      clipboardBtnCopies.on('error', function() {
        changeTooltipMessage(e.trigger,'Appuyez sur Ctrl+C ou Command+C pour copier');
      });
    });
  }

  // Bigfoot
  $(".footnotes > li").addClass("footnote");
  $.bigfoot({
    activateOnHover: true,
    actionOriginalFN: "ignore"
});
});
</script>

<!-- Utterances comments --->
<script src="https://utteranc.es/client.js"
        repo="larmarange/analyse-R"
        issue-term="pathname"
        label="commentaires"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>

<!-- disqus -->
<!---
<div class="row">
  <div id="disqus_thread" class="col-sm-9" role="complementary"></div>
</div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'analyse-r'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Veuillez activer JavaScript pour voir les <a href="http://disqus.com/?ref_noscript">les commentaires gérés avec Disqus.</a></noscript>
    <!--<a href="http://disqus.com" class="dsq-brlink">Les commentaires sont hébergés par <span class="logo-disqus">Disqus</span>.</a>-->

<footer>
  <div class="row">
    <div class="col-lg-12">
      <p>Contenus sous licence <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/fr/" rel="nofollow">Creative Commons Attribution - Pas d’utilisation commerciale - Partage dans les mêmes conditions</a>.<br />
      Propulsé par <a href="http://www.r-project.org/" rel="nofollow">R</a>, </a><a href="http://www.rstudio.com/" rel="nofollow">RStudio</a>, <a href="http://rmarkdown.rstudio.com/" rel="nofollow">R Markdown</a>, <a href="http://yihui.name/knitr/" rel="nofollow">knitr</a>, <a href="http://pandoc.org/" rel="nofollow">pandoc</a> et <a href="http://www.princexml.com/" rel="nofollow">Prince XML</a>. Hébergé par <a href="https://github.com/" rel="nofollow">GitHub</a>.<br />
      <a href="https://www.zenodo.org/badge/latestdoi/34986666"><img src="https://www.zenodo.org/badge/34986666.svg" alt="DOI"></a></p>
    </div>
  </div>
</footer>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>


</body>
</html>
